{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,4NAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,yLAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,8OAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,4RAAA,CAAA,aAAgB,AAAD,OAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,uSAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,4TAAC;QACC,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,4RAAA,CAAA,aAAgB,AAAD,OAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,4TAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/sidebar.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState, useEffect } from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Search, Plus, Book, Globe, BookOpen, Command, ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { useRouter } from \"next/navigation\"\n\n// 更新Task接口以匹配API返回格式\ninterface Task {\n  id: string\n  title: string\n  status: string // 例如 running, completed, failed, queued\n  started_at?: string\n  completed_at?: string\n  created_at: string\n  updated_at: string\n}\n\n// 用于显示的任务类型，包含UI相关属性\ninterface UITask {\n  id: string\n  title: string\n  time: string\n  status?: string\n  icon: string\n}\n\ninterface SidebarProps {\n  tasks: UITask[]\n  loading: boolean\n  error: string | null\n  onSelectTask: (taskId: string) => void\n  selectedTask: string | null\n  isOpen: boolean\n  onToggle: () => void\n  onCreateTask: () => void\n}\n\nexport function Sidebar({ \n  tasks, \n  loading, \n  error, \n  onSelectTask, \n  selectedTask, \n  isOpen, \n  onToggle, \n  onCreateTask \n}: SidebarProps) {\n  const [searchQuery, setSearchQuery] = useState(\"\")\n  const [searchFocused, setSearchFocused] = useState(false)\n\n  // 根据icon字符串返回对应的图标组件\n  const getIconComponent = (iconName: string) => {\n    switch (iconName) {\n      case 'book-open':\n        return <BookOpen className=\"h-5 w-5 text-gray-700\" />\n      case 'globe':\n        return <Globe className=\"h-5 w-5 text-gray-700\" />\n      case 'book':\n      default:\n        return <Book className=\"h-5 w-5 text-gray-700\" />\n    }\n  }\n\n  const filteredTasks = tasks.filter((task) => \n    (task.title || '').toLowerCase().includes(searchQuery.toLowerCase())\n  )\n  \n\n  // 处理新建任务的快捷键\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"k\" && (e.metaKey || e.ctrlKey)) {\n        e.preventDefault()\n        onCreateTask()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [onCreateTask])\n\n  if (!isOpen) {\n    return (\n      <div className=\"flex h-full w-12 flex-col items-center bg-[#ebebeb] py-3\">\n        <Button variant=\"ghost\" size=\"icon\" className=\"mb-4 h-8 w-8 text-gray-500\" onClick={onToggle}>\n          <ChevronRight className=\"h-5 w-5\" />\n        </Button>\n        <div className=\"flex flex-col items-center gap-4\">\n          {tasks.map((task) => (\n            <Button\n              key={task.id}\n              variant=\"ghost\"\n              size=\"icon\"\n              className={cn(\"h-8 w-8 rounded-full\", selectedTask === task.id ? \"bg-gray-200\" : \"\")}\n              onClick={() => onSelectTask(task.id)}\n            >\n              {getIconComponent(task.icon)}\n            </Button>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex h-full w-full flex-col bg-[#ebebeb]\">\n      {/* 头部 */}\n      <div className=\"flex h-14 items-center justify-between px-4\">\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-gray-500\" onClick={onToggle}>\n          <ChevronLeft className=\"h-5 w-5\" />\n        </Button>\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-gray-500\" onClick={() => {}}>\n          <Search className=\"h-5 w-5\" />\n        </Button>\n      </div>\n\n      {/* 新建任务按钮 */}\n      <div className=\"px-4 pb-3\">\n        <Button\n          className=\"w-full justify-between gap-2 bg-white text-gray-700 hover:bg-gray-50 border border-gray-200 h-10 rounded-xl text-sm font-normal\"\n          variant=\"outline\"\n          onClick={onCreateTask}\n        >\n          <div className=\"flex items-center gap-2\">\n            <Plus className=\"h-4 w-4\" />\n            <span>新建任务</span>\n          </div>\n          <div className=\"flex items-center gap-1 text-xs text-gray-400\">\n            <Command className=\"h-3 w-3\" />\n            <span>K</span>\n          </div>\n        </Button>\n      </div>\n\n      {/* 搜索栏 - 仅在聚焦或内容时显示 */}\n      {(searchFocused || searchQuery) && (\n        <div className=\"px-4 pb-3\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n            <Input\n              placeholder=\"搜索\"\n              className=\"pl-9 h-9 border-gray-200 bg-white text-sm rounded-lg\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              onFocus={() => setSearchFocused(true)}\n              onBlur={() => setSearchFocused(false)}\n              autoFocus\n            />\n          </div>\n        </div>\n      )}\n\n      {/* 任务列表 - 加载状态 */}\n      {loading && (\n        <div className=\"flex-1 flex items-center justify-center\">\n          <p className=\"text-sm text-gray-500\">正在加载任务...</p>\n        </div>\n      )}\n\n      {/* 任务列表 - 错误状态 */}\n      {error && !loading && (\n        <div className=\"flex-1 flex items-center justify-center\">\n          <p className=\"text-sm text-red-500\">{error}</p>\n        </div>\n      )}\n\n      {/* 任务列表 - 内容 */}\n      {!loading && !error && (\n        <div className=\"flex-1 overflow-y-auto px-4\">\n          {filteredTasks.length === 0 ? (\n            <div className=\"flex h-full items-center justify-center\">\n              <p className=\"text-sm text-gray-500\">未找到任务</p>\n            </div>\n          ) : (\n            filteredTasks.map((task) => (\n              <div\n                key={task.id}\n                className={cn(\n                  \"mb-2 rounded-xl p-3 cursor-pointer\",\n                  selectedTask === task.id ? \"bg-white shadow-sm\" : \"hover:bg-white/60\",\n                )}\n                onClick={() => onSelectTask(task.id)}\n              >\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"mt-1 flex h-10 w-10 items-center justify-center rounded-full bg-gray-200\">\n                    {getIconComponent(task.icon)}\n                  </div>\n                  <div className=\"flex flex-1 flex-col gap-1\">\n                    <h3 className=\"text-sm font-medium text-gray-800\">{task.title}</h3>\n                    {task.status && <p className=\"text-xs text-gray-500 line-clamp-1\">{task.status}</p>}\n                    <div className=\"flex items-center gap-1\">\n                      <span className=\"text-xs text-gray-400\">{task.time}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 535, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/hooks/use-mobile.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\n\nexport function useMobile() {\n  const [isMobile, setIsMobile] = useState(false)\n\n  useEffect(() => {\n    const checkIfMobile = () => {\n      setIsMobile(window.innerWidth < 768)\n    }\n\n    // Initial check\n    checkIfMobile()\n\n    // Add event listener\n    window.addEventListener(\"resize\", checkIfMobile)\n\n    // Clean up\n    return () => {\n      window.removeEventListener(\"resize\", checkIfMobile)\n    }\n  }, [])\n\n  return isMobile\n}\n"],"names":[],"mappings":";;;AAEA;;AAFA;;AAIO,SAAS;;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAEzC,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;+BAAE;YACR,MAAM;qDAAgB;oBACpB,YAAY,OAAO,UAAU,GAAG;gBAClC;;YAEA,gBAAgB;YAChB;YAEA,qBAAqB;YACrB,OAAO,gBAAgB,CAAC,UAAU;YAElC,WAAW;YACX;uCAAO;oBACL,OAAO,mBAAmB,CAAC,UAAU;gBACvC;;QACF;8BAAG,EAAE;IAEL,OAAO;AACT;GArBgB","debugId":null}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/action-button.tsx"],"sourcesContent":["import type React from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { cn } from \"@/lib/utils\"\n\ninterface ActionButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  icon?: React.ReactNode\n  label: string\n}\n\nexport function ActionButton({ icon, label, className, ...props }: ActionButtonProps) {\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"sm\"\n      className={cn(\n        \"flex h-8 items-center gap-2 rounded-md border-manus-border bg-white px-3 text-xs font-normal text-manus-text hover:bg-gray-50\",\n        className,\n      )}\n      {...props}\n    >\n      {icon && <span className=\"text-manus-text-secondary\">{icon}</span>}\n      {label}\n    </Button>\n  )\n}\n"],"names":[],"mappings":";;;;AACA;AACA;;;;AAOO,SAAS,aAAa,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,OAA0B;IAClF,qBACE,4TAAC,8HAAA,CAAA,SAAM;QACL,SAAQ;QACR,MAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,iIACA;QAED,GAAG,KAAK;;YAER,sBAAQ,4TAAC;gBAAK,WAAU;0BAA6B;;;;;;YACrD;;;;;;;AAGP;KAfgB","debugId":null}},
    {"offset": {"line": 620, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/chat-actions.tsx"],"sourcesContent":["import { ActionButton } from \"./action-button\"\nimport { FileText, CornerUpLeft, MousePointer, ChevronDown } from \"lucide-react\"\n\ninterface ChatActionsProps {\n  taskId: string | null\n}\n\nexport function ChatActions({ taskId }: ChatActionsProps) {\n  const actions = [\n    {\n      id: \"extract-text\",\n      label: \"提取文本\",\n      icon: <FileText className=\"h-4 w-4\" />,\n    },\n    {\n      id: \"go-back\",\n      label: \"返回上一步\",\n      icon: <CornerUpLeft className=\"h-4 w-4\" />,\n    },\n    {\n      id: \"click-element\",\n      label: \"点击元素\",\n      icon: <MousePointer className=\"h-4 w-4\" />,\n      description: \"自由行 推荐-第一次去港澳必看攻略\",\n    },\n    {\n      id: \"wait\",\n      label: \"等待1秒\",\n      icon: <ChevronDown className=\"h-4 w-4\" />,\n    },\n  ]\n\n  return (\n    <div className=\"space-y-2 py-2\">\n      {actions.map((action) => (\n        <div key={action.id} className=\"flex items-center gap-2\">\n          <ActionButton icon={action.icon} label={action.label} />\n          {action.description && <span className=\"text-xs text-gray-500\">{action.description}</span>}\n        </div>\n      ))}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AAAA;AAAA;;;;AAMO,SAAS,YAAY,EAAE,MAAM,EAAoB;IACtD,MAAM,UAAU;QACd;YACE,IAAI;YACJ,OAAO;YACP,oBAAM,4TAAC,qSAAA,CAAA,WAAQ;gBAAC,WAAU;;;;;;QAC5B;QACA;YACE,IAAI;YACJ,OAAO;YACP,oBAAM,4TAAC,iTAAA,CAAA,eAAY;gBAAC,WAAU;;;;;;QAChC;QACA;YACE,IAAI;YACJ,OAAO;YACP,oBAAM,4TAAC,6SAAA,CAAA,eAAY;gBAAC,WAAU;;;;;;YAC9B,aAAa;QACf;QACA;YACE,IAAI;YACJ,OAAO;YACP,oBAAM,4TAAC,2SAAA,CAAA,cAAW;gBAAC,WAAU;;;;;;QAC/B;KACD;IAED,qBACE,4TAAC;QAAI,WAAU;kBACZ,QAAQ,GAAG,CAAC,CAAC,uBACZ,4TAAC;gBAAoB,WAAU;;kCAC7B,4TAAC,kIAAA,CAAA,eAAY;wBAAC,MAAM,OAAO,IAAI;wBAAE,OAAO,OAAO,KAAK;;;;;;oBACnD,OAAO,WAAW,kBAAI,4TAAC;wBAAK,WAAU;kCAAyB,OAAO,WAAW;;;;;;;eAF1E,OAAO,EAAE;;;;;;;;;;AAO3B;KAnCgB","debugId":null}},
    {"offset": {"line": 725, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/chat-area.tsx"],"sourcesContent":["\"use client\";\n\nimport type React from \"react\";\nimport { useState, useRef, useEffect, useLayoutEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useMobile } from \"@/hooks/use-mobile\";\nimport { ChatActions } from \"./chat-actions\";\nimport { useRouter } from \"next/navigation\";\nimport {\n  Task,\n  Message,\n  Operation,\n  Stage,\n  TaskMetadata,\n  TimelineItem,\n  TaskResponse,\n  TaskMetadataResponse,\n  MessageResponse,\n  StageResponse,\n  OperationResponse,\n  CreateMessageRequest\n} from \"@/types\";\n\ninterface ChatAreaProps {\n  taskId: string | null;\n  taskData: Task | null;\n  loading: boolean;\n  error: string | null;\n  onSendMessage: (content: string) => void;\n}\n\nexport function ChatArea({\n  taskId,\n  taskData,\n  loading,\n  error,\n  onSendMessage,\n}: ChatAreaProps) {\n  console.log(taskData, \"taskData\");\n  const [input, setInput] = useState(\"\");\n  const [showActions, setShowActions] = useState(false);\n  const [stagesVisible, setStagesVisible] = useState<Record<string, boolean>>(\n    {}\n  );\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const isMobile = useMobile();\n  const contentRef = useRef<HTMLDivElement>(null);\n  const [attachments, setAttachments] = useState<\n    {\n      name: string;\n      type: \"image\" | \"text\" | \"file\";\n      size: string;\n      url?: string;\n    }[]\n  >([]);\n  const router = useRouter();\n  const [viewingFile, setViewingFile] = useState<{\n    viewing: boolean;\n    name: string;\n    type: string;\n    url?: string;\n  } | null>(null);\n\n  // console.log(JSON.stringify(taskData?.stages), \"taskData\");\n\n  // 初始化阶段展开状态\n  useEffect(() => {\n    if (taskData?.stages) {\n      const initialVisibility: Record<string, boolean> = {};\n      taskData.stages.forEach((stage) => {\n        initialVisibility[stage.id] = true; // 默认展开\n      });\n      setStagesVisible(initialVisibility);\n    }\n  }, [taskData?.stages]);\n\n  // 使用useLayoutEffect来强制重新计算和应用布局\n  useLayoutEffect(() => {\n    // 强制布局计算，确保没有空白区域\n    const root = document.documentElement;\n    root.style.height = \"100%\";\n    document.body.style.height = \"100%\";\n    document.body.style.margin = \"0\";\n    document.body.style.overflow = \"hidden\";\n\n    // 确保内容区域正确填充可用空间\n    if (contentRef.current) {\n      const updateHeight = () => {\n        const viewportHeight = window.innerHeight;\n        const headerHeight = 48; // 12px * 4 (h-12)\n        const inputHeight = 56; // 按钮和输入框区域高度\n        const availableHeight = viewportHeight - headerHeight - inputHeight;\n        contentRef.current!.style.minHeight = `${availableHeight}px`;\n        contentRef.current!.style.maxHeight = `${availableHeight}px`;\n      };\n\n      updateHeight();\n      window.addEventListener(\"resize\", updateHeight);\n      return () => window.removeEventListener(\"resize\", updateHeight);\n    }\n\n    return () => {\n      // 清理\n      root.style.height = \"\";\n      document.body.style.height = \"\";\n      document.body.style.margin = \"\";\n      document.body.style.overflow = \"\";\n    };\n  }, []);\n\n  // 滚动到消息底部\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [taskData?.messages]);\n\n  const handleSendMessage = () => {\n    if (!input.trim() || !taskId) return;\n    onSendMessage(input);\n    setInput(\"\");\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const toggleActions = () => {\n    setShowActions(!showActions);\n  };\n\n  const handleAttachmentClick = (attachment: any) => {\n    console.log(\"点击附件:\", attachment);\n\n    // 如果是文本文件且没有URL，创建一个文本示例\n    let fileContent = \"\";\n    if (attachment.type === \"text\" || attachment.type === \"file\") {\n      if (!attachment.url) {\n        fileContent = `// 这是 ${attachment.name} 的示例内容\\n\\n// 文件类型: ${attachment.type}\\n// 文件大小: ${attachment.size}\\n\\n/* 这是一个示例文件，显示了Monaco编辑器的功能 */\\n\\nfunction example() {\\n  console.log(\"Hello, world!\");\\n  return true;\\n}\\n`;\n      }\n    }\n\n    // 触发自定义事件通知操作面板\n    const event = new CustomEvent(\"viewFile\", {\n      detail: {\n        fileName: attachment.name,\n        fileType: attachment.type,\n        fileUrl: attachment.url || \"\",\n        fileContent: fileContent,\n      },\n    });\n    window.dispatchEvent(event);\n\n    // 更新本地状态\n    setViewingFile({\n      viewing: true,\n      name: attachment.name,\n      type: attachment.type,\n      url: attachment.url || \"\",\n    });\n  };\n\n  // 如果没有任务数据，显示加载状态\n  if (loading && !taskData) {\n    return (\n      <div className=\"flex h-full flex-col items-center justify-center bg-[#f8f8f7]\">\n        <p className=\"text-manus-text\">正在加载...</p>\n      </div>\n    );\n  }\n\n  // 如果有错误，显示错误状态\n  if (error && !loading && !taskData) {\n    return (\n      <div className=\"flex h-full flex-col items-center justify-center bg-[#f8f8f7]\">\n        <p className=\"text-red-500\">{error}</p>\n        <Button className=\"mt-4\" onClick={() => window.location.reload()}>\n          重试\n        </Button>\n      </div>\n    );\n  }\n\n  // 添加在组件内部\n  const getDetailText = (op: Operation) => {\n    switch (op.type) {\n      case \"search\":\n        return op.content || \"搜索\";\n      case \"browse\":\n        return op.url || \"浏览网页\";\n      case \"file\":\n      case \"edit\":\n        return op.fileName ? `文件: ${op.fileName}` : \"文件操作\";\n      case \"terminal\":\n        return op.data?.command || op.content || \"终端命令\";\n      default:\n        return op.content || \"操作\";\n    }\n  };\n\n  // 渲染消息和操作的主函数\n  const renderTimelineItems = () => {\n    if (!taskData?.timeline || taskData.timeline.length === 0) {\n      return (\n        <div className=\"flex flex-col items-center justify-center py-20\">\n          <div className=\"text-center\">\n            <h3 className=\"text-lg font-medium text-manus-text mb-2\">\n              开始新的对话\n            </h3>\n            <p className=\"text-sm text-manus-text-secondary mb-6\">\n              输入您的问题或指令，AI Staff 将为您提供帮助\n            </p>\n          </div>\n        </div>\n      );\n    }\n\n    // 类型安全地排序时间轴\n    const sortedTimeline = [...taskData.timeline].sort(\n      (a, b) => a.sequence_number - b.sequence_number\n    );\n    \n    // 输出排序后的时间轴\n    // console.log(\"Sorted timeline:\", sortedTimeline);\n\n    return sortedTimeline.map((item, index) => {\n      // 用户消息\n      if (item.element_type === \"message\" && item.sender === \"user\") {\n        return (\n          <div key={item.id} className=\"animate-in mb-4 flex justify-end\">\n            <div className=\"max-w-[85%] whitespace-pre-wrap rounded-lg bg-white p-3 text-sm text-manus-text shadow-sm\">\n              {item.content}\n            </div>\n          </div>\n        );\n      }\n      \n      // 助手消息\n      else if (item.element_type === \"message\" && item.sender === \"assistant\") {\n        return (\n          <div key={item.id} className=\"animate-in mb-4 flex justify-start\">\n            <div className=\"max-w-[85%] whitespace-pre-wrap rounded-lg bg-blue-50 p-3 text-sm text-manus-text shadow-sm\">\n              {item.content}\n            </div>\n          </div>\n        );\n      }\n      \n      // 步骤\n      else if (item.element_type === \"step\") {\n        const step = taskData.stages.find(s => s.id === item.id);\n        if (!step) return null;\n        \n        // 检查下一个元素是否也是步骤\n        const nextItem = index < sortedTimeline.length - 1 ? sortedTimeline[index + 1] : null;\n        const hasNextStep = nextItem && nextItem.element_type === \"step\";\n        \n        // console.log(`Step ${item.id}, nextItem:`, nextItem, `hasNextStep:`, hasNextStep);\n        \n        return (\n          <div key={item.id} className=\"relative mt-2 mb-4\">\n            {/* 步骤垂直连接线 */}\n            {hasNextStep && (\n              <div className=\"absolute left-2.5 top-7 h-full w-0 border-l-2 border-dashed border-black -ml-px\"></div>\n            )}\n            \n            {/* 标题和折叠按钮 */}\n            <div className=\"flex items-center py-2 relative z-10\">\n              <div\n                className={`flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full ${\n                  step.status === \"completed\"\n                    ? \"bg-blue-100 text-blue-500\"\n                    : \"bg-gray-200 text-manus-text-secondary\"\n                }`}\n              >\n                <svg\n                  width=\"12\"\n                  height=\"12\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <path\n                    d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\"\n                    fill=\"currentColor\"\n                  />\n                </svg>\n              </div>\n              <div className=\"flex items-center ml-1\">\n                <span className=\"text-sm font-medium text-manus-text\">\n                  {step.title}\n                </span>\n\n                {/* 折叠/展开按钮 */}\n                <button\n                  type=\"button\"\n                  className=\"h-6 w-6 flex items-center justify-center rounded-full text-manus-text-secondary hover:bg-[#f8f8f7] ml-1\"\n                  onClick={() => {\n                    const stagesVisibility = { ...stagesVisible };\n                    stagesVisibility[step.id] = !stagesVisibility[step.id];\n                    setStagesVisible(stagesVisibility);\n                  }}\n                >\n                  {stagesVisible[step.id] ? (\n                    <svg\n                      width=\"20\"\n                      height=\"20\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path d=\"M7 14l5-5 5 5H7z\" fill=\"currentColor\" />\n                    </svg>\n                  ) : (\n                    <svg\n                      width=\"20\"\n                      height=\"20\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path d=\"M7 10l5 5 5-5H7z\" fill=\"currentColor\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* 步骤内容 - 可折叠 */}\n            {stagesVisible[step.id] && step.operations && step.operations.length > 0 && (\n              <div className=\"ml-7 space-y-3 py-2\">\n                {step.operations.map((op) => (\n                  <div key={op.id} className=\"space-y-1\">\n                    {/* 操作说明 */}\n                    <div className=\"text-sm text-manus-text-secondary pl-2 font-medium\">\n                      {op.type === \"search\" && \"搜索内容\"}\n                      {op.type === \"browse\" && \"浏览网页\"}\n                      {op.type === \"edit\" && \"编辑内容\"}\n                      {op.type === \"terminal\" && \"终端命令\"}\n                      {/* 使用安全的类型检查 */}\n                      {(op.type as string) === \"action\" && \"执行操作\"}\n                    </div>\n\n                    {/* 操作内容 */}\n                    <div className=\"flex items-center gap-2 rounded-md bg-[#f8f8f7] p-2 shadow-sm\">\n                      <div className=\"flex h-4 w-4 items-center justify-center rounded-full bg-gray-200 text-manus-text-secondary\">\n                        {/* 图标根据操作类型显示 */}\n                        {op.type === \"search\" && (\n                          <svg\n                            width=\"10\"\n                            height=\"10\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <path\n                              d=\"M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z\"\n                              fill=\"currentColor\"\n                            />\n                          </svg>\n                        )}\n                        {op.type === \"browse\" && (\n                          <svg\n                            width=\"10\"\n                            height=\"10\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <path\n                              d=\"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z\"\n                              stroke=\"currentColor\"\n                              strokeWidth=\"2\"\n                              strokeLinecap=\"round\"\n                              strokeLinejoin=\"round\"\n                            />\n                            <path\n                              d=\"M2 12H22M12 2C14.5013 4.73835 15.9228 8.29203 16 12C15.9228 15.708 14.5013 19.2616 12 22C9.49872 19.2616 8.07725 15.708 8 12C8.07725 8.29203 9.49872 4.73835 12 2Z\"\n                              stroke=\"currentColor\"\n                              strokeWidth=\"2\"\n                              strokeLinecap=\"round\"\n                              strokeLinejoin=\"round\"\n                            />\n                          </svg>\n                        )}\n                        {op.type === \"edit\" && (\n                          <svg\n                            width=\"10\"\n                            height=\"10\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <path\n                              d=\"M3 17.25V21H6.75L17.81 9.94L14.06 6.19L3 17.25Z\"\n                              fill=\"currentColor\"\n                            />\n                            <path\n                              d=\"M20.71 7.04C21.1 6.65 21.1 6.02 20.71 5.63L18.37 3.29C17.98 2.9 17.35 2.9 16.96 3.29L15.13 5.12L18.88 8.87L20.71 7.04Z\"\n                              fill=\"currentColor\"\n                            />\n                          </svg>\n                        )}\n                        {op.type === \"terminal\" && (\n                          <svg\n                            width=\"10\"\n                            height=\"10\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <path\n                              d=\"M20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM5 12L7 10L5 8L6 7L9 10L6 13L5 12ZM16 15H10V13H16V15Z\"\n                              fill=\"currentColor\"\n                            />\n                          </svg>\n                        )}\n                        {/* 使用安全的类型检查 */}\n                        {(op.type as string) === \"action\" && (\n                          <svg\n                            width=\"10\"\n                            height=\"10\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <path\n                              d=\"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z\"\n                              fill=\"currentColor\"\n                            />\n                            <path\n                              d=\"M12 11L16 15H13V19H11V15H8L12 11Z\"\n                              fill=\"currentColor\"\n                            />\n                            <path\n                              d=\"M12 13L8 9H11V5H13V9H16L12 13Z\"\n                              fill=\"currentColor\"\n                            />\n                          </svg>\n                        )}\n                      </div>\n                      <span\n                        className=\"text-xs text-manus-text-secondary truncate whitespace-nowrap overflow-hidden\"\n                        title={op.content || op.url || (op as any).file_name || op.fileName || \"操作\"}\n                      >\n                        {op.type === \"edit\" || op.type === \"file\" \n                          ? `编辑: ${(op as any).file_name || op.fileName || \"未命名文件\"}` \n                          : (op.content || op.url || (op as any).file_name || op.fileName || \"操作\")}\n                      </span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        );\n      }\n      \n      return null;\n    });\n  };\n\n  return (\n    <div className=\"flex flex-col h-full bg-[#f8f8f7] overflow-hidden\">\n      {/* 头部标题  */}\n      <div className=\"flex-none h-12 flex items-center border-b border-manus-border px-4\">\n        <h1 className=\"text-base font-medium text-manus-text\">\n          {!taskId ? \"新对话\" : taskData?.title || \"加载中...\"}\n        </h1>\n      </div>\n\n      {/* 内容区域 */}\n      <div className=\"flex-1 overflow-y-auto relative\" ref={contentRef}>\n        <div className=\"mx-auto max-w-3xl space-y-6 p-4\">\n          {renderTimelineItems()}\n\n          {showActions && <ChatActions taskId={taskId} />}\n\n          {/* 任务完成状态提示 */}\n          {taskData?.metadata.status === \"completed\" && (\n            <div className=\"flex items-center justify-center gap-2 py-2 px-4 mx-auto my-4 bg-green-50 text-green-600 rounded-full max-w-max\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\" fill=\"currentColor\" />\n              </svg>\n              <span className=\"text-sm font-medium\">\n               已完成当前任务\n              </span>\n            </div>\n          )}\n\n          {/* 增加底部间距，确保内容不被输入框遮挡 */}\n          <div ref={messagesEndRef} className=\"h-20\" />\n        </div>\n      </div>\n\n      {/* 输入框 - 使用复杂布局设计 */}\n      <div className=\"pb-3 relative bg-[#f8f8f7]\">\n        <div className=\"flex flex-col gap-3 rounded-[22px] transition-all relative bg-white py-3 max-h-[300px] shadow-[0px_12px_32px_0px_rgba(0,0,0,0.02)] border border-black/8 dark:border-manus-border\">\n          {/* 附件预览区域 - 可水平滚动 */}\n          {attachments && attachments.length > 0 && (\n            <div className=\"w-full relative rounded-md overflow-hidden flex-shrink-0 pb-3 -mb-3\">\n              {/* 左侧渐变遮罩和向左滚动按钮 - 仅在有溢出时显示 */}\n              {attachments.length > 2 && (\n                <div\n                  className=\"absolute top-0 bottom-0 left-0 z-10 flex h-full items-center gap-2.5 px-3 cursor-pointer\"\n                  onClick={() =>\n                    document\n                      .getElementById(\"attachments-scroll\")\n                      ?.scrollBy(-300, 0)\n                  }\n                  style={{\n                    backgroundImage:\n                      \"linear-gradient(270deg, rgba(255,255,255,0) 0%, #ffffff 100%)\",\n                  }}\n                >\n                  <div className=\"flex h-7 w-7 items-center justify-center rounded-full border border-gray-200 bg-white overflow-hidden cursor-pointer hover:bg-gray-50 shadow-[0_0_1.25px_0_rgba(0,0,0,0.1),0_5px_16px_0_rgba(0,0,0,0.1)] backdrop-blur-[40px]\">\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"14\"\n                      height=\"14\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"2\"\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                    >\n                      <path d=\"m15 18-6-6 6-6\"></path>\n                    </svg>\n                  </div>\n                </div>\n              )}\n\n              {/* 附件横向滚动区域 */}\n              <div\n                id=\"attachments-scroll\"\n                className=\"w-full overflow-y-hidden overflow-x-auto scrollbar-hide pb-[10px] -mb-[10px] pl-4 pr-2 flex\"\n              >\n                <div className=\"flex gap-3\">\n                  {/* 这里可以根据实际上传的附件动态生成 */}\n                  {attachments.map((attachment, index) => (\n                    <div\n                      key={index}\n                      className=\"flex items-center gap-1.5 p-2 pr-2.5 w-[280px] rounded-[10px] bg-gray-50 group/attach relative overflow-hidden cursor-pointer hover:bg-[#f8f8f7]\"\n                      onClick={() => handleAttachmentClick(attachment)}\n                    >\n                      <div className=\"flex items-center justify-center w-8 h-8 rounded-md\">\n                        {attachment.type === \"image\" ? (\n                          <img\n                            alt={attachment.name}\n                            className=\"object-cover w-full h-full border border-gray-200 rounded-md\"\n                            src={attachment.url}\n                          />\n                        ) : (\n                          <div className=\"relative flex items-center justify-center\">\n                            <svg\n                              width=\"32\"\n                              height=\"32\"\n                              viewBox=\"0 0 32 32\"\n                              fill=\"none\"\n                              xmlns=\"http://www.w3.org/2000/svg\"\n                            >\n                              <path\n                                d=\"M3.55566 26.8889C3.55566 28.6071 4.94856 30 6.66678 30H25.3334C27.0517 30 28.4446 28.6071 28.4446 26.8889V9.77778L20.6668 2H6.66678C4.94856 2 3.55566 3.39289 3.55566 5.11111V26.8889Z\"\n                                fill=\"#4D81E8\"\n                              ></path>\n                              <path\n                                d=\"M20.6685 6.66647C20.6685 8.38469 22.0613 9.77759 23.7796 9.77759H28.4462L20.6685 1.99981V6.66647Z\"\n                                fill=\"#9CC3F4\"\n                              ></path>\n                              <path\n                                opacity=\"0.9\"\n                                d=\"M10.1685 18.2363H21.8351\"\n                                stroke=\"white\"\n                                strokeWidth=\"1.75\"\n                                strokeLinecap=\"square\"\n                                strokeLinejoin=\"round\"\n                              ></path>\n                              <path\n                                opacity=\"0.9\"\n                                d=\"M10.1685 14.3472H12.1129\"\n                                stroke=\"white\"\n                                strokeWidth=\"1.75\"\n                                strokeLinecap=\"square\"\n                                strokeLinejoin=\"round\"\n                              ></path>\n                              <path\n                                opacity=\"0.9\"\n                                d=\"M15.0293 14.3472H16.9737\"\n                                stroke=\"white\"\n                                strokeWidth=\"1.75\"\n                                strokeLinecap=\"square\"\n                                strokeLinejoin=\"round\"\n                              ></path>\n                              <path\n                                opacity=\"0.9\"\n                                d=\"M10.1685 21.8333H21.8351\"\n                                stroke=\"white\"\n                                strokeWidth=\"1.75\"\n                                strokeLinecap=\"square\"\n                                strokeLinejoin=\"round\"\n                              ></path>\n                            </svg>\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex flex-col gap-0.5 flex-1 min-w-0\">\n                        <div className=\"flex-1 min-w-0 flex items-center\">\n                          <div className=\"text-sm text-manus-text text-ellipsis overflow-hidden whitespace-nowrap flex-1 min-w-0\">\n                            {attachment.name}\n                          </div>\n                          <button\n                            className=\"hidden group-hover/attach:flex rounded-full p-[2px] bg-gray-500 transition-all duration-200 hover:opacity-85\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              // 从附件列表中移除\n                              setAttachments((prev) =>\n                                prev.filter((_, i) => i !== index)\n                              );\n                            }}\n                          >\n                            <svg\n                              xmlns=\"http://www.w3.org/2000/svg\"\n                              width=\"10\"\n                              height=\"10\"\n                              viewBox=\"0 0 24 24\"\n                              fill=\"none\"\n                              stroke=\"currentColor\"\n                              strokeWidth=\"2\"\n                              strokeLinecap=\"round\"\n                              strokeLinejoin=\"round\"\n                              className=\"text-white\"\n                            >\n                              <path d=\"M18 6 6 18\"></path>\n                              <path d=\"m6 6 12 12\"></path>\n                            </svg>\n                          </button>\n                        </div>\n                        <div className=\"text-xs text-manus-text-secondary\">\n                          {attachment.type === \"image\" ? \"图片\" : \"文本\"} ·{\" \"}\n                          {attachment.size}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* 右侧渐变遮罩和向右滚动按钮 - 仅在有溢出时显示 */}\n              {attachments.length > 2 && (\n                <div\n                  className=\"absolute top-0 bottom-0 right-0 z-10 flex h-full items-center gap-2.5 px-3 cursor-pointer\"\n                  onClick={() =>\n                    document\n                      .getElementById(\"attachments-scroll\")\n                      ?.scrollBy(300, 0)\n                  }\n                  style={{\n                    backgroundImage:\n                      \"linear-gradient(90deg, rgba(255,255,255,0) 0%, #ffffff 100%)\",\n                  }}\n                >\n                  <div className=\"flex h-7 w-7 items-center justify-center rounded-full border border-gray-200 bg-white overflow-hidden cursor-pointer hover:bg-gray-50 shadow-[0_0_1.25px_0_rgba(0,0,0,0.1),0_5px_16px_0_rgba(0,0,0,0.1)] backdrop-blur-[40px]\">\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"14\"\n                      height=\"14\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      strokeWidth=\"2\"\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                    >\n                      <path d=\"m9 18 6-6-6-6\"></path>\n                    </svg>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* 文本输入区域 - 增加默认高度 */}\n          <div className=\"overflow-y-auto pl-4 pr-2 max-h-[250px]\">\n            <textarea\n              className=\"flex rounded-md border-input focus-visible:outline-none focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 overflow-auto flex-1 bg-transparent p-0 pt-[1px] border-0 focus-visible:ring-0 focus-visible:ring-offset-0 w-full placeholder:text-manus-text-secondary text-[15px] shadow-none resize-none min-h-[60px]\"\n              rows={3}\n              placeholder=\"向 AI Staff 发送消息\"\n              value={input}\n              onChange={(e) => {\n                setInput(e.target.value);\n                // 自动调整高度\n                e.target.style.height = \"auto\";\n                e.target.style.height = `${Math.max(\n                  60,\n                  Math.min(e.target.scrollHeight, 220)\n                )}px`;\n              }}\n              onKeyDown={handleKeyDown}\n              style={{\n                height: input\n                  ? `${Math.max(\n                      60,\n                      Math.min(input.split(\"\\n\").length * 24 + 36, 220)\n                    )}px`\n                  : \"60px\",\n              }}\n            />\n          </div>\n\n          {/* 底部工具栏 */}\n          <footer className=\"flex flex-row justify-between w-full px-3\">\n            {/* 左侧附件按钮 */}\n            <div className=\"flex gap-2 pe-2 items-center\">\n              <input\n                type=\"file\"\n                id=\"file-upload\"\n                className=\"hidden\"\n                onChange={(e) => {\n                  if (e.target.files && e.target.files.length > 0) {\n                    const file = e.target.files[0];\n                    const newAttachment = {\n                      name: file.name,\n                      type: file.type.startsWith(\"image/\")\n                        ? (\"image\" as const)\n                        : (\"file\" as const),\n                      size: `${(file.size / 1024).toFixed(2)} KB`,\n                      url: file.type.startsWith(\"image/\")\n                        ? URL.createObjectURL(file)\n                        : undefined,\n                    };\n\n                    setAttachments((prev) => [...prev, newAttachment]);\n                    e.target.value = \"\";\n                  }\n                }}\n                multiple={false}\n              />\n              <button\n                className=\"rounded-full border border-manus-border inline-flex items-center justify-center gap-1 cursor-pointer text-xs text-manus-text-secondary hover:bg-[#f8f8f7] w-8 h-8 p-0\"\n                onClick={() => document.getElementById(\"file-upload\")?.click()}\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"16\"\n                  height=\"16\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                >\n                  <path d=\"M13.234 20.252 21 12.3\"></path>\n                  <path d=\"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486\"></path>\n                </svg>\n              </button>\n            </div>\n\n            {/* 中间字数统计 */}\n            <div className=\"ml-0 mr-auto inline-flex items-center text-xs font-normal leading-none text-manus-text-secondary\">\n              {input.length > 800 ? (\n                <span className=\"text-red-500\">{input.length}</span>\n              ) : (\n                <span>{input.length}</span>\n              )}\n              /1000\n            </div>\n\n            {/* 右侧发送按钮 */}\n            <div className=\"flex gap-2\">\n              <button\n                className={`whitespace-nowrap text-sm font-medium focus-visible:outline-none p-0 w-8 h-8 rounded-full flex items-center justify-center transition-colors ${\n                  !input.trim() && attachments.length === 0\n                    ? \"cursor-not-allowed bg-[#f8f8f7] text-gray-400\"\n                    : \"bg-blue-500 text-white hover:bg-blue-600\"\n                }`}\n                onClick={handleSendMessage}\n                disabled={!input.trim() && attachments.length === 0}\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"15\"\n                  height=\"15\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                >\n                  <path d=\"m22 2-7 20-4-9-9-4Z\" />\n                  <path d=\"M22 2 11 13\" />\n                </svg>\n              </button>\n            </div>\n          </footer>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1931, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-components/operation-container.tsx"],"sourcesContent":["import React from \"react\";\n\ninterface OperationContainerProps {\n  title: string;\n  icon?: React.ReactNode;\n  children: React.ReactNode;\n}\n\nexport function OperationContainer({\n  title,\n  icon,\n  children\n}: OperationContainerProps) {\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* 上部分：只显示标题和图标 */}\n      <div className=\"bg-white dark:bg-slate-900 p-3 border-b border-gray-200 dark:border-gray-700 flex items-center\">\n        {icon && <div className=\"mr-2\">{icon}</div>}\n        <div className=\"truncate\">\n          <h3 className=\"text-sm font-medium text-gray-800 dark:text-gray-200 truncate\">{title}</h3>\n        </div>\n      </div>\n      \n      {/* 下部分：内容区域，铺满剩余空间 */}\n      <div className=\"flex-1 overflow-auto\">\n        {children}\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":";;;;;AAQO,SAAS,mBAAmB,EACjC,KAAK,EACL,IAAI,EACJ,QAAQ,EACgB;IACxB,qBACE,4TAAC;QAAI,WAAU;;0BAEb,4TAAC;gBAAI,WAAU;;oBACZ,sBAAQ,4TAAC;wBAAI,WAAU;kCAAQ;;;;;;kCAChC,4TAAC;wBAAI,WAAU;kCACb,cAAA,4TAAC;4BAAG,WAAU;sCAAiE;;;;;;;;;;;;;;;;;0BAKnF,4TAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT;KArBgB","debugId":null}},
    {"offset": {"line": 1999, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-components/search-operation.tsx"],"sourcesContent":["import { SearchIcon } from \"lucide-react\";\nimport { SearchOperationDataResponse } from \"../operation-panel\";\nimport { OperationContainer } from \"./operation-container\";\n\ninterface SearchOperationProps {\n  data?: SearchOperationDataResponse;\n  query?: string;\n}\n\nexport function SearchOperation({ data, query }: SearchOperationProps) {\n  // 显示实际的搜索关键词作为标题\n  const searchQuery = data?.query || query || \"Search\";\n  \n  return (\n    <OperationContainer \n      title={searchQuery}\n      icon={<SearchIcon className=\"h-4 w-4\" />}\n    >\n      <div className=\"p-4\">\n        {data?.results && data.results.length > 0 ? (\n          <div className=\"space-y-6\">\n            {data.results.map((result) => (\n              <div key={result.id} className=\"pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0\">\n                <h4 className=\"text-blue-600 dark:text-blue-400 hover:underline text-lg font-medium cursor-pointer\">\n                  <a href={result.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                    {result.title}\n                  </a>\n                </h4>\n                <p className=\"text-green-700 dark:text-green-500 text-xs mt-1\">{result.url}</p>\n                <p className=\"text-sm mt-2 text-gray-600 dark:text-gray-400\">{result.description}</p>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"flex items-center justify-center h-full\">\n            <p className=\"text-gray-500\">没有搜索结果</p>\n          </div>\n        )}\n      </div>\n    </OperationContainer>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAOO,SAAS,gBAAgB,EAAE,IAAI,EAAE,KAAK,EAAwB;IACnE,iBAAiB;IACjB,MAAM,cAAc,MAAM,SAAS,SAAS;IAE5C,qBACE,4TAAC,mKAAA,CAAA,qBAAkB;QACjB,OAAO;QACP,oBAAM,4TAAC,iSAAA,CAAA,aAAU;YAAC,WAAU;;;;;;kBAE5B,cAAA,4TAAC;YAAI,WAAU;sBACZ,MAAM,WAAW,KAAK,OAAO,CAAC,MAAM,GAAG,kBACtC,4TAAC;gBAAI,WAAU;0BACZ,KAAK,OAAO,CAAC,GAAG,CAAC,CAAC,uBACjB,4TAAC;wBAAoB,WAAU;;0CAC7B,4TAAC;gCAAG,WAAU;0CACZ,cAAA,4TAAC;oCAAE,MAAM,OAAO,GAAG;oCAAE,QAAO;oCAAS,KAAI;8CACtC,OAAO,KAAK;;;;;;;;;;;0CAGjB,4TAAC;gCAAE,WAAU;0CAAmD,OAAO,GAAG;;;;;;0CAC1E,4TAAC;gCAAE,WAAU;0CAAiD,OAAO,WAAW;;;;;;;uBAPxE,OAAO,EAAE;;;;;;;;;qCAYvB,4TAAC;gBAAI,WAAU;0BACb,cAAA,4TAAC;oBAAE,WAAU;8BAAgB;;;;;;;;;;;;;;;;;;;;;AAMzC;KAhCgB","debugId":null}},
    {"offset": {"line": 2108, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-components/browse-operation.tsx"],"sourcesContent":["import { GlobeIcon } from \"lucide-react\";\nimport { BrowseOperationDataResponse } from \"../operation-panel\";\nimport { OperationContainer } from \"./operation-container\";\n\ninterface BrowseOperationProps {\n  data?: BrowseOperationDataResponse;\n  url?: string;\n}\n\nexport function BrowseOperation({ data, url }: BrowseOperationProps) {\n  const displayUrl = data?.url || url || \"\";\n  \n  return (\n    <OperationContainer \n      title={displayUrl}\n      icon={<GlobeIcon className=\"h-4 w-4\" />}\n    >\n      {data?.screenshot ? (\n        <div className=\"h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800\">\n          <img \n            src={data.screenshot} \n            alt=\"网页截图\"\n            className=\"max-w-full max-h-full object-contain\"\n          />\n        </div>\n      ) : (\n        <div className=\"h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800\">\n          <p className=\"text-gray-500\">无可用截图</p>\n        </div>\n      )}\n    </OperationContainer>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAOO,SAAS,gBAAgB,EAAE,IAAI,EAAE,GAAG,EAAwB;IACjE,MAAM,aAAa,MAAM,OAAO,OAAO;IAEvC,qBACE,4TAAC,mKAAA,CAAA,qBAAkB;QACjB,OAAO;QACP,oBAAM,4TAAC,+RAAA,CAAA,YAAS;YAAC,WAAU;;;;;;kBAE1B,MAAM,2BACL,4TAAC;YAAI,WAAU;sBACb,cAAA,4TAAC;gBACC,KAAK,KAAK,UAAU;gBACpB,KAAI;gBACJ,WAAU;;;;;;;;;;iCAId,4TAAC;YAAI,WAAU;sBACb,cAAA,4TAAC;gBAAE,WAAU;0BAAgB;;;;;;;;;;;;;;;;AAKvC;KAvBgB","debugId":null}},
    {"offset": {"line": 2176, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-components/edit-operation.tsx"],"sourcesContent":["import { FileIcon, FileTextIcon, FileCodeIcon } from \"lucide-react\";\nimport { EditOperationDataResponse } from \"../operation-panel\";\nimport { OperationContainer } from \"./operation-container\";\nimport { useState, useEffect } from \"react\";\nimport Editor from '@monaco-editor/react';\n\ninterface EditOperationProps {\n  data?: EditOperationDataResponse;\n  fileName?: string;\n}\n\nexport function EditOperation({ data, fileName }: EditOperationProps) {\n  const displayFileName = data?.fileName || fileName || \"未知文件\";\n  const [isDarkMode, setIsDarkMode] = useState(false);\n\n  // 检测当前主题\n  useEffect(() => {\n    const darkModeMediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    setIsDarkMode(darkModeMediaQuery.matches);\n    \n    const handleChange = (e: MediaQueryListEvent) => setIsDarkMode(e.matches);\n    darkModeMediaQuery.addEventListener(\"change\", handleChange);\n    \n    return () => darkModeMediaQuery.removeEventListener(\"change\", handleChange);\n  }, []);\n  \n  // 根据文件类型选择合适的图标\n  const getFileIcon = () => {\n    const fileType = data?.fileType || \"text\";\n    switch (fileType.toLowerCase()) {\n      case \"markdown\":\n      case \"md\":\n        return <FileTextIcon className=\"h-4 w-4\" />;\n      case \"javascript\":\n      case \"typescript\":\n      case \"python\":\n      case \"java\":\n        return <FileCodeIcon className=\"h-4 w-4\" />;\n      default:\n        return <FileIcon className=\"h-4 w-4\" />;\n    }\n  };\n\n  // 根据文件类型获取语言ID\n  const getLanguageId = () => {\n    const fileType = data?.fileType || \"text\";\n    switch (fileType.toLowerCase()) {\n      case \"javascript\":\n      case \"js\":\n        return \"javascript\";\n      case \"typescript\":\n      case \"ts\":\n        return \"typescript\";\n      case \"markdown\":\n      case \"md\":\n        return \"markdown\";\n      case \"python\":\n      case \"py\":\n        return \"python\";\n      case \"java\":\n        return \"java\";\n      case \"html\":\n        return \"html\";\n      case \"css\":\n        return \"css\";\n      case \"json\":\n        return \"json\";\n      default:\n        return \"plaintext\";\n    }\n  };\n\n  const modifiedContent = data?.content || \"\";\n  \n  // 编辑器选项配置 - 修复类型错误\n  const editorOptions = {\n    readOnly: true,\n    minimap: { enabled: false },\n    scrollBeyondLastLine: false,\n    wordWrap: 'on' as 'on',\n    wrappingIndent: 'same' as const,\n    contextmenu: false,\n    lineNumbers: 'on' as const,\n    renderLineHighlight: 'all' as const,\n    scrollbar: {\n      verticalScrollbarSize: 8,\n      horizontalScrollbarSize: 8,\n    },\n    fontSize: 13,\n    fontFamily: \"'JetBrains Mono', 'Menlo', 'Monaco', 'Courier New', monospace\",\n  };\n\n  // 处理编辑器挂载\n  const handleEditorDidMount = (editor: any, monaco: any) => {\n    // 添加额外的配置\n    editor.updateOptions({\n      scrollBeyondLastLine: false,\n      automaticLayout: true,\n    });\n\n    // 适配主题\n    monaco.editor.setTheme(isDarkMode ? 'vs-dark' : 'vs');\n  };\n\n  return (\n    <OperationContainer \n      title={displayFileName}\n      icon={getFileIcon()}\n    >\n      <div className=\"h-full flex flex-col\">\n        {/* 文件内容展示区域 - 直接显示内容，无需切换按钮 */}\n        <div className=\"flex-1 w-full h-full overflow-hidden\">\n          {modifiedContent ? (\n            <Editor\n              height=\"100%\"\n              width=\"100%\"\n              theme={isDarkMode ? \"vs-dark\" : \"vs\"}\n              language={getLanguageId()}\n              value={modifiedContent}\n              options={editorOptions}\n              onMount={handleEditorDidMount}\n              className=\"overflow-hidden\"\n            />\n          ) : (\n            <div className=\"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-800\">\n              <p className=\"text-gray-500 dark:text-gray-400\">文件内容为空</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </OperationContainer>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;;;;;;;AAOO,SAAS,cAAc,EAAE,IAAI,EAAE,QAAQ,EAAsB;;IAClE,MAAM,kBAAkB,MAAM,YAAY,YAAY;IACtD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,SAAS;IACT,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;mCAAE;YACR,MAAM,qBAAqB,OAAO,UAAU,CAAC;YAC7C,cAAc,mBAAmB,OAAO;YAExC,MAAM;wDAAe,CAAC,IAA2B,cAAc,EAAE,OAAO;;YACxE,mBAAmB,gBAAgB,CAAC,UAAU;YAE9C;2CAAO,IAAM,mBAAmB,mBAAmB,CAAC,UAAU;;QAChE;kCAAG,EAAE;IAEL,gBAAgB;IAChB,MAAM,cAAc;QAClB,MAAM,WAAW,MAAM,YAAY;QACnC,OAAQ,SAAS,WAAW;YAC1B,KAAK;YACL,KAAK;gBACH,qBAAO,4TAAC,ySAAA,CAAA,eAAY;oBAAC,WAAU;;;;;;YACjC,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;gBACH,qBAAO,4TAAC,ySAAA,CAAA,eAAY;oBAAC,WAAU;;;;;;YACjC;gBACE,qBAAO,4TAAC,6RAAA,CAAA,WAAQ;oBAAC,WAAU;;;;;;QAC/B;IACF;IAEA,eAAe;IACf,MAAM,gBAAgB;QACpB,MAAM,WAAW,MAAM,YAAY;QACnC,OAAQ,SAAS,WAAW;YAC1B,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;YACL,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,kBAAkB,MAAM,WAAW;IAEzC,mBAAmB;IACnB,MAAM,gBAAgB;QACpB,UAAU;QACV,SAAS;YAAE,SAAS;QAAM;QAC1B,sBAAsB;QACtB,UAAU;QACV,gBAAgB;QAChB,aAAa;QACb,aAAa;QACb,qBAAqB;QACrB,WAAW;YACT,uBAAuB;YACvB,yBAAyB;QAC3B;QACA,UAAU;QACV,YAAY;IACd;IAEA,UAAU;IACV,MAAM,uBAAuB,CAAC,QAAa;QACzC,UAAU;QACV,OAAO,aAAa,CAAC;YACnB,sBAAsB;YACtB,iBAAiB;QACnB;QAEA,OAAO;QACP,OAAO,MAAM,CAAC,QAAQ,CAAC,aAAa,YAAY;IAClD;IAEA,qBACE,4TAAC,mKAAA,CAAA,qBAAkB;QACjB,OAAO;QACP,MAAM;kBAEN,cAAA,4TAAC;YAAI,WAAU;sBAEb,cAAA,4TAAC;gBAAI,WAAU;0BACZ,gCACC,4TAAC,sWAAA,CAAA,UAAM;oBACL,QAAO;oBACP,OAAM;oBACN,OAAO,aAAa,YAAY;oBAChC,UAAU;oBACV,OAAO;oBACP,SAAS;oBACT,SAAS;oBACT,WAAU;;;;;yCAGZ,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAE,WAAU;kCAAmC;;;;;;;;;;;;;;;;;;;;;;;;;;AAO9D;GAzHgB;KAAA","debugId":null}},
    {"offset": {"line": 2367, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-components/terminal-operation.tsx"],"sourcesContent":["import { TerminalIcon } from \"lucide-react\";\nimport { TerminalOperationDataResponse } from \"../operation-panel\";\nimport { OperationContainer } from \"./operation-container\";\nimport { useEffect, useState } from \"react\";\nimport Editor from '@monaco-editor/react';\n\ninterface TerminalOperationProps {\n  data?: TerminalOperationDataResponse;\n  content?: string;\n}\n\nexport function TerminalOperation({ data, content }: TerminalOperationProps) {\n  // 获取命令和输出\n  const command = data?.command || content || \"Terminal\";\n  const output = data?.output || \"\";\n  const [isDarkMode, setIsDarkMode] = useState(true);\n  \n  // 检测当前主题 (终端默认使用暗色主题)\n  useEffect(() => {\n    const darkModeMediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    setIsDarkMode(true); // 终端始终使用暗色主题\n    \n    return () => {};\n  }, []);\n\n  // 创建包含命令和输出的完整文本\n  const fullTerminalText = `$ ${command}\\n${output}`;\n  \n  // Monaco Editor 配置 - 修复类型错误\n  const editorOptions: any = {\n    readOnly: true,\n    minimap: { enabled: false },\n    scrollBeyondLastLine: false,\n    wordWrap: 'on' as 'on',\n    wrappingIndent: 'same' as const,\n    lineNumbers: 'off' as 'off',\n    renderLineHighlight: 'none' as const,\n    scrollbar: {\n      verticalScrollbarSize: 8,\n      horizontalScrollbarSize: 8\n    },\n    fontSize: 13,\n    fontFamily: \"'JetBrains Mono', 'Menlo', 'Monaco', 'Courier New', monospace\",\n    contextmenu: false,\n    overviewRulerBorder: false,\n    renderIndentGuides: false,\n    renderFinalNewline: false,\n    cursorStyle: 'line' as const,\n    cursorBlinking: 'blink' as const,\n    cursorWidth: 0\n  };\n\n  // 自定义终端主题的配置\n  const beforeMount = (monaco: typeof import('monaco-editor')) => {\n    monaco.editor.defineTheme('terminal-dark', {\n      base: 'vs-dark',\n      inherit: true,\n      rules: [\n        { token: 'comment', foreground: '888888' },\n        { token: 'keyword', foreground: 'ff79c6' },\n        { token: 'string', foreground: 'f1fa8c' },\n        { token: 'number', foreground: 'bd93f9' }\n      ],\n      colors: {\n        'editor.background': '#1e1e1e',\n        'editor.foreground': '#f8f8f2',\n        'editorCursor.foreground': '#f8f8f2',\n        'editor.lineHighlightBackground': '#44475a',\n        'editorLineNumber.foreground': '#6272a4',\n        'editor.selectionBackground': '#44475a',\n        'editor.selectionHighlightBackground': '#424450'\n      }\n    });\n  };\n\n  const handleEditorDidMount = (editor: any, monaco: any) => {\n    // 添加额外的配置\n    editor.updateOptions({\n      automaticLayout: true,\n    });\n    \n    // 禁用编辑功能\n    editor.onDidAttemptReadOnlyEdit(() => {\n      // 阻止编辑\n    });\n  };\n\n  return (\n    <OperationContainer \n      title={command}\n      icon={<TerminalIcon className=\"h-4 w-4\" />}\n    >\n      <div className=\"h-full bg-gray-900 dark:bg-black text-white overflow-hidden\">\n        <Editor\n          height=\"100%\"\n          theme=\"terminal-dark\"\n          language=\"shell\"\n          value={fullTerminalText}\n          options={editorOptions}\n          beforeMount={beforeMount}\n          onMount={handleEditorDidMount}\n          className=\"terminal-editor\"\n        />\n      </div>\n    </OperationContainer>\n  );\n} "],"names":[],"mappings":";;;;AAAA;AAEA;AACA;AACA;AAAA;;;;;;;AAOO,SAAS,kBAAkB,EAAE,IAAI,EAAE,OAAO,EAA0B;;IACzE,UAAU;IACV,MAAM,UAAU,MAAM,WAAW,WAAW;IAC5C,MAAM,SAAS,MAAM,UAAU;IAC/B,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,sBAAsB;IACtB,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;uCAAE;YACR,MAAM,qBAAqB,OAAO,UAAU,CAAC;YAC7C,cAAc,OAAO,aAAa;YAElC;+CAAO,KAAO;;QAChB;sCAAG,EAAE;IAEL,iBAAiB;IACjB,MAAM,mBAAmB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,QAAQ;IAElD,4BAA4B;IAC5B,MAAM,gBAAqB;QACzB,UAAU;QACV,SAAS;YAAE,SAAS;QAAM;QAC1B,sBAAsB;QACtB,UAAU;QACV,gBAAgB;QAChB,aAAa;QACb,qBAAqB;QACrB,WAAW;YACT,uBAAuB;YACvB,yBAAyB;QAC3B;QACA,UAAU;QACV,YAAY;QACZ,aAAa;QACb,qBAAqB;QACrB,oBAAoB;QACpB,oBAAoB;QACpB,aAAa;QACb,gBAAgB;QAChB,aAAa;IACf;IAEA,aAAa;IACb,MAAM,cAAc,CAAC;QACnB,OAAO,MAAM,CAAC,WAAW,CAAC,iBAAiB;YACzC,MAAM;YACN,SAAS;YACT,OAAO;gBACL;oBAAE,OAAO;oBAAW,YAAY;gBAAS;gBACzC;oBAAE,OAAO;oBAAW,YAAY;gBAAS;gBACzC;oBAAE,OAAO;oBAAU,YAAY;gBAAS;gBACxC;oBAAE,OAAO;oBAAU,YAAY;gBAAS;aACzC;YACD,QAAQ;gBACN,qBAAqB;gBACrB,qBAAqB;gBACrB,2BAA2B;gBAC3B,kCAAkC;gBAClC,+BAA+B;gBAC/B,8BAA8B;gBAC9B,uCAAuC;YACzC;QACF;IACF;IAEA,MAAM,uBAAuB,CAAC,QAAa;QACzC,UAAU;QACV,OAAO,aAAa,CAAC;YACnB,iBAAiB;QACnB;QAEA,SAAS;QACT,OAAO,wBAAwB,CAAC;QAC9B,OAAO;QACT;IACF;IAEA,qBACE,4TAAC,mKAAA,CAAA,qBAAkB;QACjB,OAAO;QACP,oBAAM,4TAAC,qSAAA,CAAA,eAAY;YAAC,WAAU;;;;;;kBAE9B,cAAA,4TAAC;YAAI,WAAU;sBACb,cAAA,4TAAC,sWAAA,CAAA,UAAM;gBACL,QAAO;gBACP,OAAM;gBACN,UAAS;gBACT,OAAO;gBACP,SAAS;gBACT,aAAa;gBACb,SAAS;gBACT,WAAU;;;;;;;;;;;;;;;;AAKpB;GA/FgB;KAAA","debugId":null}},
    {"offset": {"line": 2518, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/attachment-viewer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  ChevronLeft,\n  ChevronRight,\n  X,\n  Maximize,\n  Minimize,\n  Download,\n  Copy,\n  ExternalLink,\n} from \"lucide-react\";\nimport dynamic from \"next/dynamic\";\n\n// 动态导入 Monaco Editor 以避免服务器端渲染问题\nconst Editor = dynamic(\n  () => import(\"@monaco-editor/react\").then((mod) => mod.Editor),\n  {\n    ssr: false,\n    loading: () => (\n      <div className=\"flex h-full items-center justify-center\">\n        <p>加载编辑器中...</p>\n      </div>\n    ),\n  }\n);\n\ninterface AttachmentViewerProps {\n  fileName: string;\n  fileType: string;\n  fileContent?: string;\n  fileUrl?: string;\n  onClose: () => void;\n  onNext?: () => void;\n  onPrevious?: () => void;\n  hasNext?: boolean;\n  hasPrevious?: boolean;\n}\n\nexport function AttachmentViewer({\n  fileName,\n  fileType,\n  fileContent,\n  fileUrl,\n  onClose,\n  onNext,\n  onPrevious,\n  hasNext = false,\n  hasPrevious = false,\n}: AttachmentViewerProps) {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [code, setCode] = useState<string>(fileContent || \"\");\n  const [isLoading, setIsLoading] = useState(!fileContent && !code);\n  const editorRef = useRef<any>(null);\n\n  useEffect(() => {\n    // 如果没有传入内容但有URL，尝试获取文件内容\n    const fetchFileContent = async () => {\n      if (!fileContent && fileUrl) {\n        try {\n          setIsLoading(true);\n          // todo: 需要上传到后端获取url\n          try {\n            const response = await fetch(fileUrl);\n            const text = await response.text();\n            setCode(text);\n          } catch (e) {\n            console.error(\"获取文件内容失败:\", e);\n          }\n        } catch (error) {\n          console.error(\"Failed to fetch file content:\", error);\n          setCode(\n            `// 无法加载文件内容: ${fileName}\\n// 这可能是因为文件格式不支持或文件无法访问\\n// 错误信息: ${error}`\n          );\n        } finally {\n          setIsLoading(false);\n        }\n      } else if (!fileContent && !fileUrl) {\n        setCode(`// ${fileName}\\n// 没有提供文件内容或URL`);\n        setIsLoading(false);\n      }\n    };\n\n    fetchFileContent();\n  }, [fileContent, fileUrl, fileName, fileType]);\n\n  // 处理编辑器挂载\n  const handleEditorDidMount = (editor: any) => {\n    editorRef.current = editor;\n    // 编辑器加载完成后，如果内容为空，添加一些默认内容\n    if (!code) {\n      const defaultContent = `// ${fileName}\\n// 文件内容为空或无法加载`;\n      setCode(defaultContent);\n      editor.setValue(defaultContent);\n    }\n  };\n\n  // 确定编辑器语言\n  const getEditorLanguage = () => {\n    if (fileName) {\n      const extension = fileName.split(\".\").pop()?.toLowerCase();\n\n      const extensionMap: Record<string, string> = {\n        js: \"javascript\",\n        jsx: \"javascript\",\n        ts: \"typescript\",\n        tsx: \"typescript\",\n        html: \"html\",\n        css: \"css\",\n        json: \"json\",\n        md: \"markdown\",\n        py: \"python\",\n        java: \"java\",\n        c: \"c\",\n        cpp: \"cpp\",\n        cs: \"csharp\",\n        go: \"go\",\n        php: \"php\",\n        rb: \"ruby\",\n        rs: \"rust\",\n        swift: \"swift\",\n        sh: \"shell\",\n        txt: \"plaintext\",\n      };\n\n      return extension ? extensionMap[extension] || \"plaintext\" : \"plaintext\";\n    }\n\n    return \"plaintext\";\n  };\n\n  // 复制代码到剪贴板\n  const handleCopyCode = () => {\n    if (editorRef.current) {\n      const code = editorRef.current.getValue();\n      navigator.clipboard\n        .writeText(code)\n        .then(() => {\n          console.log(\"代码已复制到剪贴板\");\n        })\n        .catch((err) => {\n          console.error(\"无法复制代码:\", err);\n        });\n    }\n  };\n\n  // 下载文件\n  const handleDownload = () => {\n    if (fileUrl) {\n      const a = document.createElement(\"a\");\n      a.href = fileUrl;\n      a.download = fileName;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      return;\n    }\n\n    // 如果没有URL但有内容，创建blob下载\n    const blob = new Blob([code], { type: \"text/plain\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = fileName;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  };\n\n  // 切换全屏\n  const toggleFullscreen = () => {\n    setIsFullscreen(!isFullscreen);\n  };\n\n  // 对于图片文件，显示图片查看器\n  if (fileType === \"image\" && fileUrl) {\n    return (\n      <div\n        className={`flex flex-col h-full ${\n          isFullscreen ? \"fixed inset-0 z-50 bg-white\" : \"\"\n        }`}\n      >\n        {/* 头部工具栏 */}\n        <div className=\"flex h-12 items-center justify-between border-b border-gray-200 dark:border-gray-700 px-4\">\n          <div className=\"flex items-center\">\n            <h2 className=\"text-base font-medium text-gray-800 dark:text-gray-200 truncate max-w-[200px]\">\n              {fileName}\n            </h2>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-gray-500\"\n              onClick={handleDownload}\n              title=\"下载图片\"\n            >\n              <Download className=\"h-4 w-4\" />\n            </Button>\n\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-gray-500\"\n              onClick={toggleFullscreen}\n              title={isFullscreen ? \"退出全屏\" : \"全屏查看\"}\n            >\n              {isFullscreen ? (\n                <Minimize className=\"h-4 w-4\" />\n              ) : (\n                <Maximize className=\"h-4 w-4\" />\n              )}\n            </Button>\n\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-gray-500\"\n              onClick={onClose}\n              title=\"关闭\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n\n        {/* 图片容器 */}\n        <div className=\"flex-1 overflow-auto flex items-center justify-center p-4 bg-gray-100\">\n          <img\n            src={fileUrl}\n            alt={fileName}\n            className=\"max-w-full max-h-full object-contain\"\n          />\n        </div>\n\n        {/* 底部导航 */}\n        {(hasPrevious || hasNext) && (\n          <div className=\"flex justify-between p-2 border-t border-gray-200 dark:border-gray-700\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"text-gray-500\"\n              onClick={onPrevious}\n              disabled={!hasPrevious}\n            >\n              <ChevronLeft className=\"h-4 w-4 mr-1\" />\n              上一个文件\n            </Button>\n\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"text-gray-500\"\n              onClick={onNext}\n              disabled={!hasNext}\n            >\n              下一个文件\n              <ChevronRight className=\"h-4 w-4 ml-1\" />\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={`flex flex-col h-full ${\n        isFullscreen ? \"fixed inset-0 z-50 bg-white\" : \"\"\n      }`}\n    >\n      {/* 头部工具栏 */}\n      <div className=\"flex h-12 items-center justify-between border-b border-gray-200 dark:border-gray-700 px-4\">\n        <div className=\"flex items-center\">\n          <h2 className=\"text-base font-medium text-gray-800 dark:text-gray-200 truncate max-w-[200px]\">\n            {fileName}\n          </h2>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-8 w-8 text-gray-500\"\n            onClick={handleCopyCode}\n            title=\"复制代码\"\n          >\n            <Copy className=\"h-4 w-4\" />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-8 w-8 text-gray-500\"\n            onClick={handleDownload}\n            title=\"下载文件\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-8 w-8 text-gray-500\"\n            onClick={toggleFullscreen}\n            title={isFullscreen ? \"退出全屏\" : \"全屏查看\"}\n          >\n            {isFullscreen ? (\n              <Minimize className=\"h-4 w-4\" />\n            ) : (\n              <Maximize className=\"h-4 w-4\" />\n            )}\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-8 w-8 text-gray-500\"\n            onClick={onClose}\n            title=\"关闭\"\n          >\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </div>\n\n      {/* 编辑器容器 */}\n      <div className=\"flex-1 overflow-hidden\">\n        {isLoading ? (\n          <div className=\"flex h-full items-center justify-center\">\n            <p className=\"text-manus-text-secondary\">加载中...</p>\n          </div>\n        ) : (\n          <Editor\n            height=\"100%\"\n            language={getEditorLanguage()}\n            value={code}\n            theme=\"vs-dark\"\n            options={{\n              readOnly: true,\n              minimap: { enabled: true },\n              scrollBeyondLastLine: false,\n              fontFamily: \"'Fira Code', monospace\",\n              fontSize: 14,\n              lineNumbers: \"on\",\n              wordWrap: \"on\",\n            }}\n            onMount={handleEditorDidMount}\n          />\n        )}\n      </div>\n\n      {/* 底部导航 */}\n      {(hasPrevious || hasNext) && (\n        <div className=\"flex justify-between p-2 border-t border-gray-200 dark:border-gray-700\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"text-gray-500\"\n            onClick={onPrevious}\n            disabled={!hasPrevious}\n          >\n            <ChevronLeft className=\"h-4 w-4 mr-1\" />\n            上一个文件\n          </Button>\n\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"text-gray-500\"\n            onClick={onNext}\n            disabled={!hasNext}\n          >\n            下一个文件\n            <ChevronRight className=\"h-4 w-4 ml-1\" />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3088, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/components/operation-panel.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { ChevronLeft, ChevronRight, Play, Pause} from \"lucide-react\"\nimport { SearchOperation } from \"./operation-components/search-operation\"\nimport { BrowseOperation } from \"./operation-components/browse-operation\"\nimport { EditOperation } from \"./operation-components/edit-operation\"\nimport { TerminalOperation } from \"./operation-components/terminal-operation\"\nimport { AttachmentViewer } from \"./attachment-viewer\"\nimport {\n  OperationStep,\n  OperationSubStep,\n  SearchOperationDataResponse,\n  BrowseOperationDataResponse,\n  EditOperationDataResponse,\n  TerminalOperationDataResponse,\n  ActionOperationDataResponse,\n  MessageOperationDataResponse,\n  SearchResultItemResponse\n} from \"@/types\"\n\ninterface OperationPanelProps {\n  taskId: string | null;\n  operationSteps: OperationStep[];\n  loading: boolean;\n}\n\nexport function OperationPanel({ taskId, operationSteps, loading }: OperationPanelProps) {\n  const [currentStep, setCurrentStep] = useState(0)\n  const [currentSubStep, setCurrentSubStep] = useState(0)\n  const [isPlaying, setIsPlaying] = useState(false)\n  const [viewingFile, setViewingFile] = useState<{\n    viewing: boolean;\n    fileName: string;\n    fileType: string;\n    fileUrl?: string;\n  } | null>(null);\n  const [isDragging, setIsDragging] = useState(false);\n\n  // **重置当前步骤索引，当 operationSteps 变化时**\n  useEffect(() => {\n    // 当 operationSteps 更新时，确保索引在有效范围内\n    if (operationSteps.length > 0) {\n      if (currentStep >= operationSteps.length) {\n        setCurrentStep(operationSteps.length - 1);\n      }\n      const currentStepData = operationSteps[currentStep];\n      if (currentStepData && currentSubStep >= currentStepData.subSteps.length) {\n        setCurrentSubStep(Math.max(0, currentStepData.subSteps.length - 1));\n      }\n    } else {\n      setCurrentStep(0);\n      setCurrentSubStep(0);\n    }\n  }, [operationSteps, currentStep, currentSubStep]);\n\n  // 监听文件查看事件\n  useEffect(() => {\n    const handleViewFile = (event: CustomEvent) => {\n      console.log(\"接收到文件查看事件:\", event.detail);\n      if (event.detail) {\n        const { fileName, fileType, fileUrl } = event.detail;\n        setViewingFile({\n          viewing: true,\n          fileName: fileName || \"未命名文件\",\n          fileType: fileType || \"text\",\n          fileUrl: fileUrl || \"\"\n        });\n      }\n    };\n\n    window.addEventListener('viewFile', handleViewFile as EventListener);\n    return () => {\n      window.removeEventListener('viewFile', handleViewFile as EventListener);\n    };\n  }, []);\n\n  const nextStep = () => {\n    const currentStepData = operationSteps[currentStep]\n    if (currentSubStep < currentStepData.subSteps.length - 1) {\n      setCurrentSubStep(currentSubStep + 1)\n    } else if (currentStep < operationSteps.length - 1) {\n      setCurrentStep(currentStep + 1)\n      setCurrentSubStep(0)\n    }\n  }\n\n  const prevStep = () => {\n    if (currentSubStep > 0) {\n      setCurrentSubStep(currentSubStep - 1)\n    } else if (currentStep > 0) {\n      setCurrentStep(currentStep - 1)\n      const prevStepSubSteps = operationSteps[currentStep - 1].subSteps\n      setCurrentSubStep(prevStepSubSteps.length - 1)\n    }\n  }\n\n  const togglePlay = () => {\n    setIsPlaying(!isPlaying)\n  }\n  \n  // **自动播放逻辑**\n  useEffect(() => {\n    let interval: NodeJS.Timeout\n    if (isPlaying) {\n      interval = setInterval(() => {\n        const currentStepData = operationSteps[currentStep]\n        if (!currentStepData) return\n\n        if (currentSubStep < currentStepData.subSteps.length - 1) {\n          setCurrentSubStep((prev) => prev + 1)\n        } else if (currentStep < operationSteps.length - 1) {\n          setCurrentStep((prev) => prev + 1)\n          setCurrentSubStep(0)\n        } else {\n          setIsPlaying(false)\n        }\n      }, 3000)\n    }\n    return () => clearInterval(interval)\n  }, [isPlaying, currentStep, currentSubStep, operationSteps])\n\n  // 处理关闭文件查看器\n  const handleCloseViewer = () => {\n    console.log(\"关闭文件查看器\");\n    setViewingFile(null);\n  }\n  \n  // 如果处于文件查看模式，返回文件查看组件\n  if (viewingFile && viewingFile.viewing) {\n    console.log(\"渲染文件查看器:\", viewingFile);\n    return (\n      <div className=\"flex h-screen flex-col bg-white dark:bg-slate-900 overflow-hidden\">\n        <AttachmentViewer\n          fileName={viewingFile.fileName}\n          fileType={viewingFile.fileType}\n          fileUrl={viewingFile.fileUrl}\n          fileContent={viewingFile.fileType === 'text' ? \"这是文件内容示例\" : undefined}\n          onClose={handleCloseViewer}\n        />\n      </div>\n    );\n  }\n\n  // **处理新任务状态**\n  if (taskId && taskId.startsWith(\"new-task\")) {\n    return (\n      <div className=\"flex h-screen flex-col bg-[#f8f8f7]\">\n        <div className=\"flex h-12 items-center justify-between border-b border-manus-border px-4\">\n          <h2 className=\"text-base font-medium text-manus-text\">AI Staff 的电脑</h2>\n        </div>\n        <div className=\"flex flex-1 items-center justify-center\">\n          <div className=\"text-center max-w-md px-4\">\n            <p className=\"text-manus-text-secondary mb-2\">\n              开始新的对话，AI Staff 将在这里显示操作内容\n            </p>\n            <p className=\"text-xs text-manus-text-secondary\">\n              请在左侧输入指令以开始交互，AI 的操作将会显示在这里\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // **处理空状态或加载状态**\n  if ((!taskId || taskId === \"null\" || taskId === \"undefined\") && operationSteps.length === 0) {\n    return (\n      <div className=\"flex h-screen flex-col bg-[#f8f8f7]\">\n        <div className=\"flex h-12 items-center justify-between border-b border-manus-border px-4\">\n          <h2 className=\"text-base font-medium text-manus-text\">AI Staff 的电脑</h2>\n        </div>\n        <div className=\"flex flex-1 items-center justify-center\">\n          <div className=\"text-center max-w-md px-4\">\n            <p className=\"text-manus-text-secondary mb-2\">\n              {!taskId ? \"请选择一个任务\" : \"开始新的对话，AI Staff 将在这里显示操作内容\"}\n            </p>\n            <p className=\"text-xs text-manus-text-secondary\">\n              AI Staff 会在这里展示搜索、浏览和编辑等操作的详细内容\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // **处理加载中状态**\n  if (loading || (taskId && operationSteps.length === 0)) {\n    return (\n      <div className=\"flex h-screen flex-col bg-[#f8f8f7]\">\n        <div className=\"flex h-12 items-center justify-between border-b border-manus-border px-4\">\n          <h2 className=\"text-base font-medium text-manus-text\">AI Staff 的电脑</h2>\n        </div>\n        <div className=\"flex flex-1 items-center justify-center\">\n          <div className=\"text-center\">\n            <p className=\"text-manus-text-secondary\">\n              {loading ? \"正在加载操作内容...\" : \"暂无操作记录\"}\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const currentStepData = operationSteps[currentStep]\n  const currentSubStepData = currentStepData?.subSteps[currentSubStep]\n\n  // **渲染操作内容**\n  const renderOperationContent = () => {\n    if (!currentSubStepData) return null\n\n    switch (currentSubStepData.type) {\n      case \"search\":\n        const searchData = currentSubStepData.data as SearchOperationDataResponse | undefined;\n        return (\n          <SearchOperation \n            data={searchData} \n            query={currentSubStepData.content} \n          />\n        );\n      case \"browse\":\n        const browseData = currentSubStepData.data as BrowseOperationDataResponse | undefined;\n        return (\n          <BrowseOperation \n            data={browseData} \n            url={currentSubStepData.url} \n          />\n        );\n      case \"edit\":\n        const editData = currentSubStepData.data as EditOperationDataResponse | undefined;\n        return (\n          <EditOperation \n            data={editData} \n            fileName={currentSubStepData.fileName} \n          />\n        );\n      case \"terminal\":\n        const terminalData = currentSubStepData.data as TerminalOperationDataResponse | undefined;\n        return (\n          <TerminalOperation \n            data={terminalData}\n            content={currentSubStepData.content} \n          />\n        );\n      case \"message\":\n      case \"action\":\n      default:\n        return (\n          <div className=\"h-full flex items-center justify-center\">\n            <p className=\"text-manus-text-secondary\">不支持的操作类型</p>\n          </div>\n        );\n    }\n  }\n\n  // **拖动处理函数**\n  const handleDragStart = (e: React.MouseEvent) => {\n    setIsDragging(true);\n    handleProgressBarClick(e);\n    \n    document.addEventListener('mousemove', handleDragMove);\n    document.addEventListener('mouseup', handleDragEnd);\n  };\n\n  const handleDragMove = (e: MouseEvent) => {\n    if (!isDragging) return;\n    \n    const progressBar = document.querySelector('.progress-bar-container');\n    if (!progressBar) return;\n    \n    const rect = progressBar.getBoundingClientRect();\n    const offsetX = Math.max(0, Math.min(e.clientX - rect.left, rect.width));\n    const percentage = offsetX / rect.width;\n    \n    updatePositionFromPercentage(percentage);\n  };\n\n  const handleDragEnd = () => {\n    setIsDragging(false);\n    document.removeEventListener('mousemove', handleDragMove);\n    document.removeEventListener('mouseup', handleDragEnd);\n  };\n\n  // **提取共用的位置更新逻辑**\n  const updatePositionFromPercentage = (percentage: number) => {\n    const totalSubSteps = operationSteps.reduce((acc, step) => acc + step.subSteps.length, 0);\n    const targetPosition = Math.floor(percentage * totalSubSteps);\n    \n    let targetStep = 0;\n    let targetSubStep = 0;\n    let currentCount = 0;\n    \n    for (let i = 0; i < operationSteps.length; i++) {\n      if (currentCount + operationSteps[i].subSteps.length > targetPosition) {\n        targetStep = i;\n        targetSubStep = targetPosition - currentCount;\n        break;\n      }\n      currentCount += operationSteps[i].subSteps.length;\n    }\n    \n    setCurrentStep(targetStep);\n    setCurrentSubStep(targetSubStep);\n  };\n\n  // **复用点击处理函数**\n  const handleProgressBarClick = (e: React.MouseEvent) => {\n    const progressBar = e.currentTarget;\n    const rect = progressBar.getBoundingClientRect();\n    const offsetX = e.clientX - rect.left;\n    const percentage = offsetX / rect.width;\n    \n    updatePositionFromPercentage(percentage);\n  };\n\n  return (\n    <div className=\"flex h-screen flex-col bg-white dark:bg-slate-900 overflow-hidden\">\n      <div className=\"flex h-12 items-center border-b border-gray-200 dark:border-gray-700 px-4\">\n        <h2 className=\"text-base font-medium text-gray-800 dark:text-gray-200\">AI Staff 的电脑</h2>\n      </div>\n\n      {/* 操作内容区域 */}\n      <div className=\"flex-1 overflow-hidden\">\n        {renderOperationContent()}\n      </div>\n\n      {/* 底部控制栏 */}\n      <div className=\"border-t border-gray-200 dark:border-gray-700 p-3\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-gray-500\"\n              onClick={prevStep}\n              disabled={currentStep === 0 && currentSubStep === 0}\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </Button>\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-gray-500\" onClick={togglePlay}>\n              {isPlaying ? <Pause className=\"h-4 w-4\" /> : <Play className=\"h-4 w-4\" />}\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-gray-500\"\n              onClick={nextStep}\n              disabled={\n                operationSteps.length === 0 ||\n                (currentStep === operationSteps.length - 1 &&\n                currentSubStep === operationSteps[operationSteps.length - 1]?.subSteps.length - 1)\n              }\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n        \n        {/* 进度条 */}\n        <div \n          className=\"h-1 rounded-full bg-[#f8f8f7] dark:bg-gray-800 relative cursor-pointer progress-bar-container\"\n          onClick={handleProgressBarClick}\n          onMouseDown={handleDragStart}\n        >\n          <div\n            className=\"h-full rounded-full bg-blue-500 transition-all duration-300\"\n            style={{\n              width: `${(() => {\n                const totalSubSteps = operationSteps.reduce((acc, step) => acc + step.subSteps.length, 0);\n                let currentPosition = 0;\n                for (let i = 0; i < currentStep; i++) {\n                  currentPosition += operationSteps[i].subSteps.length;\n                }\n                currentPosition += currentSubStep;\n                \n                if (currentStep === operationSteps.length - 1 && \n                    currentSubStep === operationSteps[operationSteps.length - 1].subSteps.length - 1) {\n                  return 100;\n                }\n                \n                return totalSubSteps > 0 ? (currentPosition / (totalSubSteps - 1)) * 100 : 0;\n              })()}%`,\n            }}\n          ></div>\n        </div>\n        \n        <div className=\"mt-2 flex items-center justify-between\">\n          <div className=\"flex items-center gap-1\">\n            <div className=\"h-2 w-2 rounded-full bg-blue-500\"></div>\n            <span className=\"text-xs text-gray-500 truncate max-w-[200px]\">\n              {currentStepData?.title || \"AI Staff 正在工作\"}\n            </span>\n          </div>\n          <div className=\"text-xs text-gray-500\">\n            {currentSubStepData?.timestamp.toLocaleTimeString([], {\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n            })}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;AATA;;;;;;;;;AA4BO,SAAS,eAAe,EAAE,MAAM,EAAE,cAAc,EAAE,OAAO,EAAuB;;IACrF,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IACrD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAKnC;IACV,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,oCAAoC;IACpC,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;oCAAE;YACR,kCAAkC;YAClC,IAAI,eAAe,MAAM,GAAG,GAAG;gBAC7B,IAAI,eAAe,eAAe,MAAM,EAAE;oBACxC,eAAe,eAAe,MAAM,GAAG;gBACzC;gBACA,MAAM,kBAAkB,cAAc,CAAC,YAAY;gBACnD,IAAI,mBAAmB,kBAAkB,gBAAgB,QAAQ,CAAC,MAAM,EAAE;oBACxE,kBAAkB,KAAK,GAAG,CAAC,GAAG,gBAAgB,QAAQ,CAAC,MAAM,GAAG;gBAClE;YACF,OAAO;gBACL,eAAe;gBACf,kBAAkB;YACpB;QACF;mCAAG;QAAC;QAAgB;QAAa;KAAe;IAEhD,WAAW;IACX,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM;2DAAiB,CAAC;oBACtB,QAAQ,GAAG,CAAC,cAAc,MAAM,MAAM;oBACtC,IAAI,MAAM,MAAM,EAAE;wBAChB,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,MAAM,MAAM;wBACpD,eAAe;4BACb,SAAS;4BACT,UAAU,YAAY;4BACtB,UAAU,YAAY;4BACtB,SAAS,WAAW;wBACtB;oBACF;gBACF;;YAEA,OAAO,gBAAgB,CAAC,YAAY;YACpC;4CAAO;oBACL,OAAO,mBAAmB,CAAC,YAAY;gBACzC;;QACF;mCAAG,EAAE;IAEL,MAAM,WAAW;QACf,MAAM,kBAAkB,cAAc,CAAC,YAAY;QACnD,IAAI,iBAAiB,gBAAgB,QAAQ,CAAC,MAAM,GAAG,GAAG;YACxD,kBAAkB,iBAAiB;QACrC,OAAO,IAAI,cAAc,eAAe,MAAM,GAAG,GAAG;YAClD,eAAe,cAAc;YAC7B,kBAAkB;QACpB;IACF;IAEA,MAAM,WAAW;QACf,IAAI,iBAAiB,GAAG;YACtB,kBAAkB,iBAAiB;QACrC,OAAO,IAAI,cAAc,GAAG;YAC1B,eAAe,cAAc;YAC7B,MAAM,mBAAmB,cAAc,CAAC,cAAc,EAAE,CAAC,QAAQ;YACjE,kBAAkB,iBAAiB,MAAM,GAAG;QAC9C;IACF;IAEA,MAAM,aAAa;QACjB,aAAa,CAAC;IAChB;IAEA,aAAa;IACb,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;oCAAE;YACR,IAAI;YACJ,IAAI,WAAW;gBACb,WAAW;gDAAY;wBACrB,MAAM,kBAAkB,cAAc,CAAC,YAAY;wBACnD,IAAI,CAAC,iBAAiB;wBAEtB,IAAI,iBAAiB,gBAAgB,QAAQ,CAAC,MAAM,GAAG,GAAG;4BACxD;4DAAkB,CAAC,OAAS,OAAO;;wBACrC,OAAO,IAAI,cAAc,eAAe,MAAM,GAAG,GAAG;4BAClD;4DAAe,CAAC,OAAS,OAAO;;4BAChC,kBAAkB;wBACpB,OAAO;4BACL,aAAa;wBACf;oBACF;+CAAG;YACL;YACA;4CAAO,IAAM,cAAc;;QAC7B;mCAAG;QAAC;QAAW;QAAa;QAAgB;KAAe;IAE3D,YAAY;IACZ,MAAM,oBAAoB;QACxB,QAAQ,GAAG,CAAC;QACZ,eAAe;IACjB;IAEA,sBAAsB;IACtB,IAAI,eAAe,YAAY,OAAO,EAAE;QACtC,QAAQ,GAAG,CAAC,YAAY;QACxB,qBACE,4TAAC;YAAI,WAAU;sBACb,cAAA,4TAAC,sIAAA,CAAA,mBAAgB;gBACf,UAAU,YAAY,QAAQ;gBAC9B,UAAU,YAAY,QAAQ;gBAC9B,SAAS,YAAY,OAAO;gBAC5B,aAAa,YAAY,QAAQ,KAAK,SAAS,aAAa;gBAC5D,SAAS;;;;;;;;;;;IAIjB;IAEA,cAAc;IACd,IAAI,UAAU,OAAO,UAAU,CAAC,aAAa;QAC3C,qBACE,4TAAC;YAAI,WAAU;;8BACb,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAG,WAAU;kCAAwC;;;;;;;;;;;8BAExD,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAI,WAAU;;0CACb,4TAAC;gCAAE,WAAU;0CAAiC;;;;;;0CAG9C,4TAAC;gCAAE,WAAU;0CAAoC;;;;;;;;;;;;;;;;;;;;;;;IAO3D;IAEA,iBAAiB;IACjB,IAAI,CAAC,CAAC,UAAU,WAAW,UAAU,WAAW,WAAW,KAAK,eAAe,MAAM,KAAK,GAAG;QAC3F,qBACE,4TAAC;YAAI,WAAU;;8BACb,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAG,WAAU;kCAAwC;;;;;;;;;;;8BAExD,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAI,WAAU;;0CACb,4TAAC;gCAAE,WAAU;0CACV,CAAC,SAAS,YAAY;;;;;;0CAEzB,4TAAC;gCAAE,WAAU;0CAAoC;;;;;;;;;;;;;;;;;;;;;;;IAO3D;IAEA,cAAc;IACd,IAAI,WAAY,UAAU,eAAe,MAAM,KAAK,GAAI;QACtD,qBACE,4TAAC;YAAI,WAAU;;8BACb,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAG,WAAU;kCAAwC;;;;;;;;;;;8BAExD,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAI,WAAU;kCACb,cAAA,4TAAC;4BAAE,WAAU;sCACV,UAAU,gBAAgB;;;;;;;;;;;;;;;;;;;;;;IAMvC;IAEA,MAAM,kBAAkB,cAAc,CAAC,YAAY;IACnD,MAAM,qBAAqB,iBAAiB,QAAQ,CAAC,eAAe;IAEpE,aAAa;IACb,MAAM,yBAAyB;QAC7B,IAAI,CAAC,oBAAoB,OAAO;QAEhC,OAAQ,mBAAmB,IAAI;YAC7B,KAAK;gBACH,MAAM,aAAa,mBAAmB,IAAI;gBAC1C,qBACE,4TAAC,gKAAA,CAAA,kBAAe;oBACd,MAAM;oBACN,OAAO,mBAAmB,OAAO;;;;;;YAGvC,KAAK;gBACH,MAAM,aAAa,mBAAmB,IAAI;gBAC1C,qBACE,4TAAC,gKAAA,CAAA,kBAAe;oBACd,MAAM;oBACN,KAAK,mBAAmB,GAAG;;;;;;YAGjC,KAAK;gBACH,MAAM,WAAW,mBAAmB,IAAI;gBACxC,qBACE,4TAAC,8JAAA,CAAA,gBAAa;oBACZ,MAAM;oBACN,UAAU,mBAAmB,QAAQ;;;;;;YAG3C,KAAK;gBACH,MAAM,eAAe,mBAAmB,IAAI;gBAC5C,qBACE,4TAAC,kKAAA,CAAA,oBAAiB;oBAChB,MAAM;oBACN,SAAS,mBAAmB,OAAO;;;;;;YAGzC,KAAK;YACL,KAAK;YACL;gBACE,qBACE,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAE,WAAU;kCAA4B;;;;;;;;;;;QAGjD;IACF;IAEA,aAAa;IACb,MAAM,kBAAkB,CAAC;QACvB,cAAc;QACd,uBAAuB;QAEvB,SAAS,gBAAgB,CAAC,aAAa;QACvC,SAAS,gBAAgB,CAAC,WAAW;IACvC;IAEA,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,YAAY;QAEjB,MAAM,cAAc,SAAS,aAAa,CAAC;QAC3C,IAAI,CAAC,aAAa;QAElB,MAAM,OAAO,YAAY,qBAAqB;QAC9C,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,OAAO,GAAG,KAAK,IAAI,EAAE,KAAK,KAAK;QACtE,MAAM,aAAa,UAAU,KAAK,KAAK;QAEvC,6BAA6B;IAC/B;IAEA,MAAM,gBAAgB;QACpB,cAAc;QACd,SAAS,mBAAmB,CAAC,aAAa;QAC1C,SAAS,mBAAmB,CAAC,WAAW;IAC1C;IAEA,kBAAkB;IAClB,MAAM,+BAA+B,CAAC;QACpC,MAAM,gBAAgB,eAAe,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,CAAC,MAAM,EAAE;QACvF,MAAM,iBAAiB,KAAK,KAAK,CAAC,aAAa;QAE/C,IAAI,aAAa;QACjB,IAAI,gBAAgB;QACpB,IAAI,eAAe;QAEnB,IAAK,IAAI,IAAI,GAAG,IAAI,eAAe,MAAM,EAAE,IAAK;YAC9C,IAAI,eAAe,cAAc,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,GAAG,gBAAgB;gBACrE,aAAa;gBACb,gBAAgB,iBAAiB;gBACjC;YACF;YACA,gBAAgB,cAAc,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM;QACnD;QAEA,eAAe;QACf,kBAAkB;IACpB;IAEA,eAAe;IACf,MAAM,yBAAyB,CAAC;QAC9B,MAAM,cAAc,EAAE,aAAa;QACnC,MAAM,OAAO,YAAY,qBAAqB;QAC9C,MAAM,UAAU,EAAE,OAAO,GAAG,KAAK,IAAI;QACrC,MAAM,aAAa,UAAU,KAAK,KAAK;QAEvC,6BAA6B;IAC/B;IAEA,qBACE,4TAAC;QAAI,WAAU;;0BACb,4TAAC;gBAAI,WAAU;0BACb,cAAA,4TAAC;oBAAG,WAAU;8BAAyD;;;;;;;;;;;0BAIzE,4TAAC;gBAAI,WAAU;0BACZ;;;;;;0BAIH,4TAAC;gBAAI,WAAU;;kCACb,4TAAC;wBAAI,WAAU;kCACb,cAAA,4TAAC;4BAAI,WAAU;;8CACb,4TAAC,8HAAA,CAAA,SAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,WAAU;oCACV,SAAS;oCACT,UAAU,gBAAgB,KAAK,mBAAmB;8CAElD,cAAA,4TAAC,2SAAA,CAAA,cAAW;wCAAC,WAAU;;;;;;;;;;;8CAEzB,4TAAC,8HAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAQ,MAAK;oCAAO,WAAU;oCAAwB,SAAS;8CAC5E,0BAAY,4TAAC,2RAAA,CAAA,QAAK;wCAAC,WAAU;;;;;6DAAe,4TAAC,yRAAA,CAAA,OAAI;wCAAC,WAAU;;;;;;;;;;;8CAE/D,4TAAC,8HAAA,CAAA,SAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,WAAU;oCACV,SAAS;oCACT,UACE,eAAe,MAAM,KAAK,KACzB,gBAAgB,eAAe,MAAM,GAAG,KACzC,mBAAmB,cAAc,CAAC,eAAe,MAAM,GAAG,EAAE,EAAE,SAAS,SAAS;8CAGlF,cAAA,4TAAC,6SAAA,CAAA,eAAY;wCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;kCAM9B,4TAAC;wBACC,WAAU;wBACV,SAAS;wBACT,aAAa;kCAEb,cAAA,4TAAC;4BACC,WAAU;4BACV,OAAO;gCACL,OAAO,GAAG,CAAC;oCACT,MAAM,gBAAgB,eAAe,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,CAAC,MAAM,EAAE;oCACvF,IAAI,kBAAkB;oCACtB,IAAK,IAAI,IAAI,GAAG,IAAI,aAAa,IAAK;wCACpC,mBAAmB,cAAc,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM;oCACtD;oCACA,mBAAmB;oCAEnB,IAAI,gBAAgB,eAAe,MAAM,GAAG,KACxC,mBAAmB,cAAc,CAAC,eAAe,MAAM,GAAG,EAAE,CAAC,QAAQ,CAAC,MAAM,GAAG,GAAG;wCACpF,OAAO;oCACT;oCAEA,OAAO,gBAAgB,IAAI,AAAC,kBAAkB,CAAC,gBAAgB,CAAC,IAAK,MAAM;gCAC7E,CAAC,IAAI,CAAC,CAAC;4BACT;;;;;;;;;;;kCAIJ,4TAAC;wBAAI,WAAU;;0CACb,4TAAC;gCAAI,WAAU;;kDACb,4TAAC;wCAAI,WAAU;;;;;;kDACf,4TAAC;wCAAK,WAAU;kDACb,iBAAiB,SAAS;;;;;;;;;;;;0CAG/B,4TAAC;gCAAI,WAAU;0CACZ,oBAAoB,UAAU,mBAAmB,EAAE,EAAE;oCACpD,MAAM;oCACN,QAAQ;gCACV;;;;;;;;;;;;;;;;;;;;;;;;AAMZ;GAxXgB;KAAA","debugId":null}},
    {"offset": {"line": 3734, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/types/agent.ts"],"sourcesContent":["export enum TAB {\n  BROWSER = \"browser\",\n  CODE = \"code\",\n  TERMINAL = \"terminal\",\n}\n\nexport type Source = {\n  title: string;\n  url: string;\n};\n\nexport enum AgentEvent {\n  USER_MESSAGE = \"user_message\",\n  CONNECTION_ESTABLISHED = \"connection_established\",\n  WORKSPACE_INFO = \"workspace_info\",\n  PROCESSING = \"processing\",\n  AGENT_THINKING = \"agent_thinking\",\n  TOOL_CALL = \"tool_call\",\n  TOOL_RESULT = \"tool_result\",\n  AGENT_RESPONSE = \"agent_response\",\n  STREAM_COMPLETE = \"stream_complete\",\n  ERROR = \"error\",\n  SYSTEM = \"system\",\n  PONG = \"pong\",\n  UPLOAD_SUCCESS = \"upload_success\",\n  BROWSER_USE = \"browser_use\",\n  FILE_EDIT = \"file_edit\",\n}\n\nexport enum TOOL {\n  SEQUENTIAL_THINKING = \"sequential_thinking\",\n  STR_REPLACE_EDITOR = \"str_replace_editor\",\n  BROWSER_USE = \"browser_use\",\n  PRESENTATION = \"presentation\",\n  WEB_SEARCH = \"web_search\",\n  IMAGE_SEARCH = \"image_search\",\n  VISIT = \"visit_webpage\",\n  BASH = \"bash\",\n  COMPLETE = \"complete\",\n  STATIC_DEPLOY = \"static_deploy\",\n  PDF_TEXT_EXTRACT = \"pdf_text_extract\",\n  AUDIO_TRANSCRIBE = \"audio_transcribe\",\n  GENERATE_AUDIO_RESPONSE = \"generate_audio_response\",\n  VIDEO_GENERATE = \"generate_video_from_text\",\n  IMAGE_GENERATE = \"generate_image_from_text\",\n  DEEP_RESEARCH = \"deep_research\",\n  LIST_HTML_LINKS = \"list_html_links\",\n  // browser tools\n  BROWSER_VIEW = \"browser_view\",\n  BROWSER_NAVIGATION = \"browser_navigation\",\n  BROWSER_RESTART = \"browser_restart\",\n  BROWSER_WAIT = \"browser_wait\",\n  BROWSER_SCROLL_DOWN = \"browser_scroll_down\",\n  BROWSER_SCROLL_UP = \"browser_scroll_up\",\n  BROWSER_CLICK = \"browser_click\",\n  BROWSER_ENTER_TEXT = \"browser_enter_text\",\n  BROWSER_PRESS_KEY = \"browser_press_key\",\n  BROWSER_GET_SELECT_OPTIONS = \"browser_get_select_options\",\n  BROWSER_SELECT_DROPDOWN_OPTION = \"browser_select_dropdown_option\",\n  BROWSER_SWITCH_TAB = \"browser_switch_tab\",\n  BROWSER_OPEN_NEW_TAB = \"browser_open_new_tab\",\n}\n\nexport type ActionStep = {\n  type: TOOL;\n  data: {\n    isResult?: boolean;\n    tool_name?: string;\n    tool_input?: {\n      description?: string;\n      action?: string;\n      text?: string;\n      thought?: string;\n      path?: string;\n      file_text?: string;\n      file_path?: string;\n      command?: string;\n      url?: string;\n      query?: string;\n      file?: string;\n      instruction?: string;\n      output_filename?: string;\n      key?: string;\n    };\n    result?: string | Record<string, unknown>;\n    query?: string;\n    content?: string;\n    path?: string;\n  };\n};\n\nexport interface Messages {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content?: string;\n  timestamp: number;\n  action?: ActionStep;\n  files?: string[]; // File names\n  fileContents?: { [filename: string]: string }; // Base64 content of files\n}\n\nexport interface ISession {\n  id: string;\n  workspace_dir: string;\n  created_at: string;\n  device_id: string;\n  first_message: string;\n}\n\nexport interface IEvent {\n  id: string;\n  event_type: AgentEvent;\n  event_payload: {\n    type: AgentEvent;\n    content: Record<string, unknown>;\n  };\n  timestamp: string;\n  workspace_dir: string;\n}\n"],"names":[],"mappings":";;;;;AAAO,IAAA,AAAK,6BAAA;;;;WAAA;;AAWL,IAAA,AAAK,oCAAA;;;;;;;;;;;;;;;;WAAA;;AAkBL,IAAA,AAAK,8BAAA;;;;;;;;;;;;;;;;;;IAkBV,gBAAgB;;;;;;;;;;;;;;WAlBN","debugId":null}},
    {"offset": {"line": 3806, "column": 0}, "map": {"version":3,"sources":["file:///Users/baicai/Desktop/Agent%E7%A0%94%E7%A9%B6/LocalManus/local-manus/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { toast } from \"sonner\";\nimport { useState, useEffect, useRef, useCallback, useMemo } from \"react\"\nimport { Sidebar } from \"@/components/sidebar\"\nimport { ChatArea } from \"@/components/chat-area\"\nimport { OperationPanel } from \"@/components/operation-panel\"\nimport { useMobile } from \"@/hooks/use-mobile\"\nimport { Task, UITask, OperationStep, OperationSubStep ,Stage,Operation,TimelineItem,Message} from \"@/types\"\nimport{SearchOperationDataResponse \n  ,BrowseOperationDataResponse \n  ,EditOperationDataResponse \n  ,ActionOperationDataResponse\n  ,MessageOperationDataResponse\n  ,TerminalOperationDataResponse,\n  SearchResultItemResponse} from \"@/types\"\nimport Cookies from \"js-cookie\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { cloneDeep, debounce } from \"lodash\";\nimport {\n  ActionStep,   // 代理执行的动作步骤类型\n  AgentEvent,   // WebSocket 事件类型枚举\n  IEvent,       // 通用事件接口 (用于历史记录)\n  Messages,      // 聊天消息类型\n  TAB,          // 面板标签页枚举 (浏览器, 代码, 终端)\n  TOOL,         // 工具类型枚举\n} from \"@/types/agent\";\nexport default function Home() {\n  const [currentActionData, setCurrentActionData] = useState<ActionStep>();\n  const messagesEndRef = useRef<HTMLDivElement | null>(null);\n  const [sidebarOpen, setSidebarOpen] = useState(true)\n  const [selectedTask, setSelectedTask] = useState<string | null>(null)\n  const [taskList, setTaskList] = useState<UITask[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [taskDetails, setTaskDetails] = useState<any | null>(null)\n  const [operationSteps, setOperationSteps] = useState<OperationStep[]>([])\n  const isMobile = useMobile()\n  const [deviceId, setDeviceId] = useState<string>(\"\");\n  const [sessionId, setSessionId] = useState<string | null>(null);\n  const [isLoadingSession, setIsLoadingSession] = useState(false);\n  const [workspaceInfo, setWorkspaceInfo] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [messages, setMessages] = useState<Messages[]>([]);\n  const [isCompleted, setIsCompleted] = useState(false);\n  const [browserUrl, setBrowserUrl] = useState(\"\");\n  const searchParams = useSearchParams();\n  const [filesContent, setFilesContent] = useState<{ [key: string]: string }>(\n    {}\n  );\n  const [uploadedFiles, setUploadedFiles] = useState<string[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n\n  const [sessions, setSessions] = useState<UITask[]>([])\n  const [activeSessionId, setActiveSessionId] = useState<string | null>(null); // 当前活动的会话 ID 状态\n  const [currentQuestion, setCurrentQuestion] = useState(\"\"); // 问题输入框中的当前文本\n  const [socket, setSocket] = useState<WebSocket | null>(null); // WebSocket 连接实例\n  const isReplayMode = useMemo(() => !!searchParams.get(\"id\"), [searchParams]);\n  const [isUseDeepResearch, setIsUseDeepResearch] = useState(true);\n\n  const [taskId,setTaskId] = useState<string>(\"\")\n\n\n\n  // WebSocket 事件处理器 (核心逻辑)\n  const handleEvent = (data: {\n    id: string; // 事件 ID (由前端生成或后端提供)\n    type: AgentEvent; // 事件类型\n    content: Record<string, unknown>; // 事件内容 (任意对象)\n  }) => {\n    switch (data.type) {\n      case AgentEvent.USER_MESSAGE: // 用户消息 (这个事件似乎不由 WebSocket 触发，而是由 handleQuestionSubmit 直接添加)\n        console.log(\"User message:\", data);\n        setMessages((prev) => [\n          ...prev,\n          {\n            id: data.id,\n            role: \"user\",\n            content: data.content.text as string,\n            timestamp: Date.now(),\n          },\n        ]);\n        break;\n      case AgentEvent.PROCESSING: // 代理正在处理\n        setIsLoading(true);\n        break;\n      case AgentEvent.WORKSPACE_INFO: // 工作区信息\n        setWorkspaceInfo(data.content.path as string);\n        break;\n      case AgentEvent.AGENT_THINKING: // 代理正在思考 (通常是文本提示)\n        setMessages((prev) => [\n          ...prev,\n          {\n            id: data.id,\n            role: \"assistant\",\n            content: data.content.text as string, // \"Thinking...\"\n            timestamp: Date.now(),\n          },\n        ]);\n        break;\n      case AgentEvent.TOOL_CALL: // 工具调用\n        // 如果是“顺序思考”工具，直接作为助手消息显示思考内容\n        if (data.content.tool_name === TOOL.SEQUENTIAL_THINKING) {\n          setMessages((prev) => [\n            ...prev,\n            {\n              id: data.id,\n              role: \"assistant\",\n              content: (data.content.tool_input as { thought: string }).thought as string,\n              timestamp: Date.now(),\n            },\n          ]);\n        } else { // 其他工具调用\n          const message: Message = {\n            id: data.id,\n            role: \"assistant\",\n            // 将工具调用信息包装在 action 字段中\n            action: { type: data.content.tool_name as TOOL, data: data.content },\n            timestamp: Date.now(),\n          };\n          // 如果工具输入包含 URL，则设置浏览器 URL\n          const url = (data.content.tool_input as { url: string })?.url as string;\n          if (url) setBrowserUrl(url);\n          setMessages((prev) => [...prev, message]); // 添加到消息列表\n          handleClickAction(message.action); // 触发 handleClickAction 更新 UI\n        }\n        break;\n      case AgentEvent.FILE_EDIT: // 文件编辑事件 (通常是代码编辑器内容变化)\n        setMessages((prev) => {\n          const lastMessage = cloneDeep(prev[prev.length - 1]); // 深拷贝最后一条消息\n          // 假设最后一条消息是 STR_REPLACE_EDITOR 工具调用\n          if (lastMessage.action && lastMessage.action.type === TOOL.STR_REPLACE_EDITOR) {\n            lastMessage.action.data.content = data.content.content as string; // 更新内容\n            lastMessage.action.data.path = data.content.path as string; // 更新路径\n            // 更新 filesContent 状态中对应文件的内容\n            const filePath = (data.content.path as string)?.includes(workspaceInfo)\n              ? (data.content.path as string)\n              : `${workspaceInfo}/${data.content.path}`;\n            setFilesContent((prevContent) => ({ ...prevContent, [filePath]: data.content.content as string }));\n          }\n          // 延迟更新 UI，确保数据已设置\n          setTimeout(() => handleClickAction(lastMessage.action), 500);\n          return [...prev.slice(0, -1), lastMessage]; // 替换最后一条消息\n        });\n        break;\n      case AgentEvent.TOOL_RESULT: // 工具执行结果\n        // 如果是 BROWSER_USE 工具，结果直接作为助手消息显示\n        if (data.content.tool_name === TOOL.BROWSER_USE) {\n          setMessages((prev) => [\n            ...prev,\n            {\n              id: data.id,\n              role: \"assistant\",\n              content: data.content.result as string, // 工具结果文本\n              timestamp: Date.now(),\n            },\n          ]);\n        } else {\n          if (data.content.tool_name !== TOOL.SEQUENTIAL_THINKING && data.content.tool_name !== TOOL.PRESENTATION) {\n            setMessages((prev) => {\n              const lastMessage = cloneDeep(prev[prev.length - 1]); // 深拷贝最后一条消息\n              // 检查最后一条消息是否是对应的工具调用\n              if (lastMessage?.action && lastMessage.action?.type === data.content.tool_name) {\n                lastMessage.action.data.result = `${data.content.result}`; // 设置结果\n                // 特殊处理浏览器相关工具的结果 (通常是截图数据)\n                if (\n                  [\n                    TOOL.BROWSER_VIEW, TOOL.BROWSER_CLICK, TOOL.BROWSER_ENTER_TEXT,\n                    TOOL.BROWSER_PRESS_KEY, TOOL.BROWSER_GET_SELECT_OPTIONS,\n                    TOOL.BROWSER_SELECT_DROPDOWN_OPTION, TOOL.BROWSER_SWITCH_TAB,\n                    TOOL.BROWSER_OPEN_NEW_TAB, TOOL.BROWSER_WAIT, TOOL.BROWSER_SCROLL_DOWN,\n                    TOOL.BROWSER_SCROLL_UP, TOOL.BROWSER_NAVIGATION, TOOL.BROWSER_RESTART,\n                  ].includes(data.content.tool_name as TOOL)\n                ) {\n                  // 从结果数组中提取图片数据\n                  lastMessage.action.data.result =\n                    data.content.result && Array.isArray(data.content.result)\n                      ? data.content.result.find((item) => item.type === \"image\")?.source?.data\n                      : undefined;\n                }\n                lastMessage.action.data.isResult = true; // 标记为结果数据\n                // 延迟更新 UI\n                setTimeout(() => handleClickAction(lastMessage.action), 500);\n                return [...prev.slice(0, -1), lastMessage]; // 替换最后一条消息\n              } else { // 如果最后一条消息不是对应的工具调用，则将结果作为新的动作消息添加\n                return [...prev, { ...lastMessage, action: data.content as ActionStep }];\n              }\n            });\n          }\n        }\n        break;\n      case AgentEvent.AGENT_RESPONSE: // 代理的最终文本响应\n        setMessages((prev) => [\n          ...prev,\n          {\n            id: Date.now().toString(), // 使用新的时间戳作为ID，确保是新消息\n            role: \"assistant\",\n            content: data.content.text as string, // 响应文本\n            timestamp: Date.now(),\n          },\n        ]);\n        setIsCompleted(true); // 标记会话/查询完成\n        setIsLoading(false); // 结束加载状态\n        break;\n      case AgentEvent.UPLOAD_SUCCESS: // 文件上传成功\n        setIsUploading(false); // 结束上传状态\n        const newFiles = data.content.files as { path: string; saved_path: string }[];\n        const paths = newFiles.map((f) => f.path); // 获取上传成功的文件路径\n        setUploadedFiles((prev) => [...prev, ...paths]); // 添加到已上传文件列表\n        break;\n      case \"error\": // WebSocket 错误事件 (自定义的，非标准 WebSocket error event)\n        toast.error(data.content.message as string); // 显示错误提示\n        setIsUploading(false); // 重置上传和加载状态\n        setIsLoading(false);\n        break;\n    }\n  };\n\n  // useEffect: 当 URL 查询参数变化时，获取 'id' 参数并设置为 sessionId\n  useEffect(() => {\n    const id = searchParams.get(\"id\");\n    setSessionId(id);\n  }, [searchParams]);\n\n  const handleClickAction = debounce(\n    (data: ActionStep | undefined, showTabOnly = false) => {\n      if (!data) return; // 如果没有数据，则返回\n\n      // 根据动作类型切换活动标签页，并设置当前动作数据\n      switch (data.type) {\n        case TOOL.WEB_SEARCH: // 网页搜索\n\n          setCurrentActionData(data);\n          break;\n\n        case TOOL.IMAGE_GENERATE: // 图像生成\n        case TOOL.BROWSER_USE:    // 浏览器使用 (通常是摘要)\n        case TOOL.VISIT:          // 访问网页 (原始HTML)\n\n          setCurrentActionData(data);\n          break;\n        // 以下都是浏览器自动化相关的工具\n        case TOOL.BROWSER_CLICK:\n        case TOOL.BROWSER_ENTER_TEXT:\n        case TOOL.BROWSER_PRESS_KEY:\n        case TOOL.BROWSER_GET_SELECT_OPTIONS:\n        case TOOL.BROWSER_SELECT_DROPDOWN_OPTION:\n        case TOOL.BROWSER_SWITCH_TAB:\n        case TOOL.BROWSER_OPEN_NEW_TAB:\n        case TOOL.BROWSER_VIEW:\n        case TOOL.BROWSER_NAVIGATION:\n        case TOOL.BROWSER_RESTART:\n        case TOOL.BROWSER_WAIT:\n        case TOOL.BROWSER_SCROLL_DOWN:\n        case TOOL.BROWSER_SCROLL_UP:\n          setCurrentActionData(data);\n          break;\n\n        case TOOL.BASH: // Bash 命令执行\n          setCurrentActionData(data);\n          break;\n\n        case TOOL.STR_REPLACE_EDITOR: // 字符串替换编辑器 (代码编辑)\n\n          setCurrentActionData(data); // 设置当前动作数据\n          // 获取文件路径\n\n          break;\n\n        default: // 其他未处理的工具类型\n          break;\n      }\n    },\n    50 // 防抖延迟 50ms\n  );\n\n  // useEffect: 当 sessionId (来自 URL) 可用时，获取会话事件历史记录\n  useEffect(() => {\n    const fetchSessionEvents = async () => {\n      const id = searchParams.get(\"id\"); // 再次获取 id，确保是最新的\n      if (!id) return; // 如果没有 id，则不执行获取\n\n      setIsLoadingSession(true); // 开始加载会话\n      try {\n        // 发起 API 请求获取指定 session ID 的事件历史\n        const response = await fetch(\n          `${process.env.NEXT_PUBLIC_API_URL}/api/sessions/${id}/events`\n        );\n\n        if (!response.ok) { // 如果请求失败\n          throw new Error(\n            `Error fetching session events: ${response.statusText}`\n          );\n        }\n\n        const data = await response.json(); // 解析 JSON 响应数据\n        // 设置工作区路径，取第一个事件中的 workspace_dir (如果存在)\n        setWorkspaceInfo(data.events?.[0]?.workspace_dir);\n\n        if (data.events && Array.isArray(data.events)) { // 如果事件数据存在且是数组\n          const reconstructedMessages: Message[] = []; // 用于存储重构后的消息\n\n          // 定义一个带延迟处理事件的异步函数\n          const processEventsWithDelay = async () => {\n            setIsLoading(true); // 开始加载状态 (模拟实时接收)\n            for (let i = 0; i < data.events.length; i++) {\n              const event = data.events[i];\n              // 每个事件处理之间增加 1.5 秒的延迟\n              await new Promise((resolve) => setTimeout(resolve, 1500));\n              // 调用 handleEvent 处理每个事件的载荷\n              handleEvent({ ...event.event_payload, id: event.id });\n            }\n            // 注意：这里的 setIsLoading(true) 之后没有对应的 setIsLoading(false)\n            // 这可能是一个 bug 或者后续的 AGENT_RESPONSE 事件会处理它\n          };\n\n          processEventsWithDelay(); // 开始带延迟地处理事件\n\n          // 如果重构消息后有内容，则设置消息状态并标记为完成\n          // 注意：reconstructedMessages 在这里是空的，因为上面的 processEventsWithDelay 是异步的\n          // 并且 handleEvent 是直接更新 messages 状态，而不是填充 reconstructedMessages。\n          // 这部分逻辑可能需要调整才能按预期工作。\n          if (reconstructedMessages.length > 0) {\n            setMessages(reconstructedMessages);\n            setIsCompleted(true);\n          }\n\n          // 从事件中提取工作区信息 (如果存在 WORKSPACE_INFO 事件)\n          const workspaceEvent = data.events.find(\n            (e: IEvent) => e.event_type === AgentEvent.WORKSPACE_INFO\n          );\n          if (workspaceEvent && workspaceEvent.event_payload.path) {\n            setWorkspaceInfo(workspaceEvent.event_payload.path as string);\n          }\n        }\n      } catch (error) { // 捕获请求或处理过程中的错误\n        console.error(\"Failed to fetch session events:\", error);\n        toast.error(\"Failed to load session history\"); // 显示错误提示\n      } finally {\n        setIsLoadingSession(false); // 结束加载会话状态\n      }\n    };\n\n    fetchSessionEvents(); // 调用获取会话事件的函数\n  }, [searchParams]); // 依赖于 searchParams 的变化\n\n\n  // useEffect: 页面加载时初始化设备 ID\n  useEffect(() => {\n    let existingDeviceId = Cookies.get(\"device_id\"); // 从 Cookie 中获取已存在的 device_id\n\n    if (!existingDeviceId) { // 如果 Cookie 中不存在\n      existingDeviceId = uuidv4(); // 生成一个新的 UUID 作为 device_id\n      // 将新的 device_id 保存到 Cookie 中，有效期一年\n      Cookies.set(\"device_id\", existingDeviceId, {\n        expires: 365, // 365 天\n        sameSite: \"strict\", // SameSite策略，增强安全性\n        secure: window.location.protocol === \"https:\", // 仅在 HTTPS 下发送 Cookie\n      });\n      console.log(\"Generated new device ID:\", existingDeviceId);\n    } else {\n      console.log(\"Using existing device ID:\", existingDeviceId);\n    }\n    setDeviceId(existingDeviceId); // 将 device_id 设置到组件状态中\n  }, []); // 空依赖数组，仅在组件首次加载时运行\n\n  // 获取任务列表\n  useEffect(() => {\n    const fetchData = async () => {\n      // 如果没有 deviceId，则不执行获取\n      if (!deviceId) return;\n\n      try {\n        setLoading(true)\n        setError(null) // 清空之前的错误信息\n\n        // 从API获取会话列表\n        const response = await fetch(\n          `${process.env.NEXT_PUBLIC_API_URL}/api/sessions/${deviceId}`\n        )\n        if (!response.ok) {\n          throw new Error(`Error fetching sessions: ${response.statusText}`)\n        }\n\n        const data = await response.json()\n        const apiSessions = data.sessions || []\n\n        // 转换为UI需要的格式（这里假设sessions需要类似tasks的处理）\n        const uiSessions = apiSessions.map((session) => {\n          // 设置图标\n          let icon\n          if (session.first_message?.includes(\"小说\")) {\n            icon = \"book-open\"\n          } else if (session.title?.includes(\"网站\") || session.title?.includes(\"APP\")) {\n            icon = \"globe\"\n          } else {\n            icon = \"book\"\n          }\n\n          // 格式化时间\n          const sessionDate = new Date(session.created_at)\n          const now = new Date()\n          const diffMs = now.getTime() - sessionDate.getTime()\n          const diffMins = Math.floor(diffMs / 60000)\n          const diffHours = Math.floor(diffMins / 60)\n          const diffDays = Math.floor(diffHours / 24)\n          const diffMonths = Math.floor(diffDays / 30)\n\n          let timeDisplay = \"\"\n          if (diffMonths > 0) {\n            timeDisplay = `${diffMonths} 个月前`\n          } else if (diffDays > 0) {\n            timeDisplay = `${diffDays} 天前`\n          } else if (diffHours > 0) {\n            timeDisplay = `${diffHours} 小时前`\n          } else if (diffMins > 0) {\n            timeDisplay = `${diffMins} 分钟前`\n          } else {\n            timeDisplay = \"刚刚\"\n          }\n\n\n\n          return {\n            ...session,\n            id: session.id,\n            title: session.first_message,\n            time: timeDisplay,\n            status: \"完成\",\n            icon: icon\n          }\n        })\n\n        setSessions(uiSessions) // 使用 setSessions 而不是 setTaskList\n\n\n      } catch (err) {\n        const error = err as Error\n        console.error(\"Failed to fetch sessions:\", error)\n        setError(`Failed to load sessions: ${error.message || \"Please try again.\"}`)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    fetchData()\n  }, [deviceId]) // 依赖项包含 deviceId\n\n\n  const handleSessionClick = (sessionId: string) => {\n    window.location.href = `/?id=${sessionId}`; // 通过修改 URL 跳转到指定会话的页面\n\n\n  };\n  // 当 URL 查询参数变化时，获取 'id' 参数并设置为 sessionId\n  useEffect(() => {\n    const id = searchParams.get(\"id\"); // 从 URL 中获取 'id' 参数\n    if (id) {\n      setActiveSessionId(id); // 如果存在 'id'，则设置为当前活动会话 ID\n    } else {\n      setActiveSessionId(null); // 否则，清空活动会话 ID\n    }\n  }, [searchParams]); // 依赖于 searchParams 的变化\n\n\n   // useEffect: 当 deviceId 和非回放模式时，建立 WebSocket 连接\n   useEffect(() => {\n    const connectWebSocket = () => {\n      const params = new URLSearchParams({ device_id: deviceId }); // 将 device_id 作为查询参数\n      const ws = new WebSocket(`${process.env.NEXT_PUBLIC_API_URL}/ws?${params.toString()}`);\n      ws.onopen = () => { // 连接打开时\n        console.log(\"WebSocket connection established\");\n        // 发送 'workspace_info' 事件请求工作区信息 (如果需要)\n        ws.send(JSON.stringify({ type: \"workspace_info\", content: {} }));\n      };\n      ws.onmessage = (event) => { // 收到消息时\n        try {\n          const data = JSON.parse(event.data as string); // 解析 JSON 数据\n          // 调用 handleEvent 处理消息，并为事件生成一个前端ID\n          handleEvent({ ...data, id: Date.now().toString() });\n        } catch (error) {\n          console.error(\"Error parsing WebSocket data:\", error);\n        }\n      };\n      ws.onerror = (error) => { // 发生错误时\n        console.log(\"WebSocket error:\", error);\n        toast.error(\"WebSocket connection error\");\n      };\n      ws.onclose = () => { // 连接关闭时\n        console.log(\"WebSocket connection closed\");\n        setSocket(null); // 清空 socket 实例\n      };\n      setSocket(ws); // 保存 socket 实例到状态\n    };\n\n    if (deviceId && !isReplayMode) { // 如果有 deviceId 且不是回放模式\n      connectWebSocket(); // 建立连接\n    }\n    return () => { // 组件卸载时的清理函数\n      if (socket) socket.close(); // 关闭 WebSocket 连接\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [deviceId, isReplayMode]); // 依赖于 deviceId 和 isReplayMode\n\n\n\n\n  // 处理用户提交问题的函数\n  const handleQuestionSubmit = async (newQuestion: string) => {\n    const newTaskId = uuidv4();\n  setTaskId(newTaskId);\n    if (!newQuestion.trim() || isLoading) return; // 如果问题为空或正在加载，则不处理\n\n    setIsLoading(true); // 开始加载状态\n    setCurrentQuestion(\"\"); // 清空问题输入框 (这个状态似乎没有被 QuestionInput 组件使用value绑定)\n    setIsCompleted(false); // 重置完成状态\n\n    // 如果 sessionId 不存在 (通常是新会话)，尝试从 workspaceInfo 中提取\n    if (!sessionId) {\n      const id = `${workspaceInfo}`.split(\"/\").pop(); // 从工作区路径末尾取ID\n      if (id) {\n        setSessionId(id);\n      }\n    }\n\n    // 创建用户消息对象\n    const newUserMessage: Messages = {\n      id: Date.now().toString(), // 使用时间戳作为ID\n      role: \"user\",\n      content: newQuestion,\n      timestamp: Date.now(),\n    };\n    setMessages((prev) => [...prev, newUserMessage]); // 将用户消息添加到消息列表\n\n    // 检查 WebSocket 连接是否正常\n    if (!socket || socket.readyState !== WebSocket.OPEN) {\n      toast.error(\"WebSocket connection is not open. Please try again.\");\n      setIsLoading(false);\n      return;\n    }\n\n    // 如果是新会话的第一次查询，发送 'init_agent' 事件\n    if (!sessionId) {\n      socket.send(\n        JSON.stringify({\n          type: \"init_agent\", // 事件类型\n          content: { // 事件内容\n            tool_args: { // 工具参数配置\n              deep_research: isUseDeepResearch, // 是否使用深度研究\n              pdf: true,              // 是否启用 PDF 工具\n              media_generation: true, // 是否启用媒体生成工具\n              audio_generation: true, // 是否启用音频生成工具\n              browser: true,          // 是否启用浏览器工具\n            },\n          },\n        })\n      );\n    }\n\n    // 发送用户查询 ('query' 事件)\n    socket.send(\n      JSON.stringify({\n        type: \"query\", // 事件类型\n        content: { // 事件内容\n          text: newQuestion, // 查询文本\n          resume: messages.length > 0, // 是否是继续对话 (基于已有消息数量)\n          // 已上传文件列表 (路径前加 '.')\n          files: uploadedFiles?.map((file) => `.${file}`),\n        },\n      })\n    );\n\n    console.log(\"发送请求\")\n  };\n\n\n  const handleChatAreaMessage = (content: string) => {\n    console.log(\"ChatArea 发送消息:\", content);\n    \n    // 如果是新对话且没有 taskId，可能需要先创建任务\n    if (!selectedTask) {\n      // 这里可能需要先创建一个新任务\n      // 或者使用不同的逻辑处理新对话\n      console.log(\"没有选中的任务，可能是新对话\");\n    }\n    \n    // 调用原有的 handleQuestionSubmit\n    handleQuestionSubmit(content);\n  };\n\n\n\n\n\n\n  const toggleSidebar = () => {\n    setSidebarOpen(!sidebarOpen);\n  };\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages?.length]);\n\n  const createTaskFromMessages = (messages: Messages[]): Task => {\n    const timestamp = new Date().toISOString();\n    const taskId = sessionId || `task_${Date.now()}`;\n    setSelectedTask(taskId);\n    \n    const taskMessages: Message[] = [];\n    const allStages: Stage[] = [];\n    const allOperations: Operation[] = [];\n    const timeline: TimelineItem[] = [];\n    //const operationSteps: OperationStep[] = []; // 新增：操作步骤数组\n    \n    // 用于跟踪当前步骤\n    let currentStep: OperationStep | null = null;\n    let stepCounter = 0;\n    \n    messages.forEach((msg, index) => {\n      // 1. 先添加用户/助手的文本消息\n      if (msg.content) {\n        const textMessage: Message = {\n          id: `${msg.id}_text`,\n          type: msg.role === \"user\" ? \"user\" : \"assistant\",\n          content: msg.content,\n          timestamp: new Date(msg.timestamp).toISOString(),\n          status: \"completed\",\n          sender: msg.role\n        };\n        taskMessages.push(textMessage);\n        \n        // **创建消息类型的子步骤**\n        const messageSubStep: OperationSubStep = {\n          id: `substep_${msg.id}_message`,\n          title: msg.role === \"user\" ? \"User Input\" : \"Assistant Response\",\n          type: \"message\",\n          description: msg.content.slice(0, 100) + (msg.content.length > 100 ? \"...\" : \"\"),\n          timestamp: new Date(msg.timestamp),\n          content: msg.content,\n          display_order: index,\n          data: {\n            role: msg.role,\n            content: msg.content,\n            status: \"completed\"\n          } as MessageOperationDataResponse\n        };\n        \n        // 如果是用户消息，创建新的操作步骤\n        if (msg.role === \"user\") {\n          stepCounter++;\n          currentStep = {\n            id: `step_${stepCounter}`,\n            title: `Step ${stepCounter}: ${msg.content.slice(0, 50)}...`,\n            description: msg.content,\n            timestamp: new Date(msg.timestamp),\n            status: \"running\",\n            sequence_number: stepCounter,\n            subSteps: [messageSubStep],\n            isExpanded: false\n          };\n          operationSteps.push(currentStep);\n        } else if (currentStep) {\n          // 如果是助手消息，添加到当前步骤\n          currentStep.subSteps.push(messageSubStep);\n        }\n      }\n      \n      // 2. 如果有 action，添加 action 消息和 stage 消息\n      if (msg.action) {\n        const operationType = getOperationType(msg.action.type);\n        const toolInput = msg.action.data.tool_input || {};\n        \n        // 创建 Operation\n        const operation: Operation = {\n          id: `op_${msg.id}`,\n          type: operationType,\n          content: toolInput.description || \n                   toolInput.text || \n                   msg.action.data.content || \n                   msg.action.data.query || \"\",\n          timestamp: new Date(msg.timestamp),\n          url: toolInput.url,\n          fileName: toolInput.file_path || toolInput.output_filename,\n          data: msg.action.data\n        };\n        allOperations.push(operation);\n        \n        // 创建 Stage\n        const stage: Stage = {\n          id: `stage_${msg.id}`,\n          title: msg.action.data.tool_name || getToolDisplayName(msg.action.type),\n          timestamp: new Date(msg.timestamp),\n          status: msg.action.data.isResult ? \"completed\" : \"running\",\n          operations: [operation]\n        };\n        allStages.push(stage);\n        \n        // 添加 action 消息（显示工具调用）\n        const actionMessage: Message = {\n          id: `${msg.id}_action`,\n          type: \"action\",\n          content: formatActionContent(msg.action),\n          timestamp: new Date(msg.timestamp).toISOString(),\n          status: msg.action.data.isResult ? \"completed\" : \"running\",\n          details: JSON.stringify(toolInput, null, 2),\n          sender: \"assistant\"\n        };\n        taskMessages.push(actionMessage);\n        \n        // 添加 stage 消息（显示执行阶段）\n        const stageMessage: Message = {\n          id: `${msg.id}_stage`,\n          type: \"stage\",\n          content: `${stage.title}: ${operation.content}`,\n          timestamp: new Date(msg.timestamp).toISOString(),\n          status: stage.status,\n          sender: \"system\"\n        };\n        taskMessages.push(stageMessage);\n        \n        // **创建操作子步骤**\n        const subStep = createOperationSubStep(msg.action, msg.id, msg.timestamp, index);\n        \n        // 如果当前没有步骤，创建一个新步骤\n        if (!currentStep) {\n          stepCounter++;\n          currentStep = {\n            id: `step_${stepCounter}`,\n            title: `Step ${stepCounter}: ${getToolDisplayName(msg.action.type)}`,\n            description: formatActionContent(msg.action),\n            timestamp: new Date(msg.timestamp),\n            status: msg.action.data.isResult ? \"completed\" : \"running\",\n            sequence_number: stepCounter,\n            subSteps: [subStep],\n            isExpanded: false\n          };\n          operationSteps.push(currentStep);\n        } else {\n          // 添加到当前步骤\n          currentStep.subSteps.push(subStep);\n          // 更新步骤状态\n          if (msg.action.data.isResult) {\n            currentStep.status = \"completed\";\n          }\n        }\n        \n        // 如果有结果，添加结果消息\n        if (msg.action.data.result) {\n          const resultMessage: Message = {\n            id: `${msg.id}_result`,\n            type: \"assistant\",\n            content: formatResult(msg.action.data.result),\n            timestamp: new Date(msg.timestamp + 1).toISOString(),\n            status: \"completed\",\n            sender: \"assistant\"\n          };\n          taskMessages.push(resultMessage);\n        }\n      }\n      \n      // 3. 添加到 timeline\n      timeline.push({\n        id: `timeline_${msg.id}`,\n        element_type: msg.action ? \"step\" : \"message\",\n        sender: msg.role === \"user\" ? \"user\" : \"assistant\",\n        content: msg.content || formatActionContent(msg.action),\n        timestamp: new Date(msg.timestamp).toISOString(),\n        sequence_number: index + 1,\n        related_step_id: msg.action ? `stage_${msg.id}` : null,\n        operations: msg.action ? [allOperations[allOperations.length - 1]] : []\n      });\n    });\n    \n    const task: Task = {\n      id: taskId,\n      title: messages[0]?.content?.slice(0, 50) || \"Untitled Task\",\n      status: isCompleted ? \"completed\" : \"running\",\n      created_at: timestamp,\n      updated_at: timestamp,\n      messages: taskMessages,\n      stages: allStages,\n      timeline: timeline,\n      operationSteps: operationSteps, // 新增：操作步骤\n      metadata: {\n        status: isCompleted ? \"completed\" : \"running\",\n        runningTime: \"0s\",\n        knowledgeSources: uploadedFiles.length,\n        dataSources: allStages.length\n      }\n    };\n    \n    return task;\n  };\n  \n  // **新增辅助函数：创建操作子步骤**\n  function createOperationSubStep(\n    action: ActionStep, \n    msgId: string, \n    timestamp: number,\n    displayOrder: number\n  ): OperationSubStep {\n    const toolInput = action.data.tool_input || {};\n    const type = getOperationSubStepType(action.type);\n    \n    const baseSubStep: OperationSubStep = {\n      id: `substep_${msgId}`,\n      title: getToolDisplayName(action.type),\n      type: type,\n      description: toolInput.description || toolInput.text || \"\",\n      timestamp: new Date(timestamp),\n      display_order: displayOrder\n    };\n    \n    // 根据不同类型添加特定数据\n    switch (type) {\n      case \"search\":\n        baseSubStep.data = {\n          query: toolInput.query || toolInput.text || \"\",\n          results: parseSearchResults(action.data.result)\n        } as SearchOperationDataResponse;\n        break;\n        \n      case \"browse\":\n        baseSubStep.url = toolInput.url;\n        baseSubStep.data = {\n          url: toolInput.url || \"\",\n          title: toolInput.text || \"Browsing page\",\n          screenshot: action.data.result?.screenshot\n        } as BrowseOperationDataResponse;\n        break;\n        \n      case \"edit\":\n        baseSubStep.fileName = toolInput.file_path || toolInput.file || \"\";\n        baseSubStep.data = {\n          fileName: toolInput.file_path || toolInput.file || \"\",\n          fileType: getFileType(toolInput.file_path || \"\"),\n          content: toolInput.file_text || toolInput.text || \"\",\n          diff: action.data.result?.diff\n        } as EditOperationDataResponse;\n        break;\n        \n      case \"terminal\":\n        baseSubStep.data = {\n          command: toolInput.command || \"\",\n          output: formatResult(action.data.result)\n        } as TerminalOperationDataResponse;\n        break;\n        \n      case \"action\":\n      default:\n        baseSubStep.data = {\n          action: action.data.tool_name || action.type,\n          details: JSON.stringify(toolInput, null, 2),\n          results: formatResult(action.data.result)\n        } as ActionOperationDataResponse;\n        break;\n    }\n    \n    return baseSubStep;\n  }\n  \n  // **新增辅助函数：获取操作子步骤类型**\n  function getOperationSubStepType(toolType: TOOL): OperationSubStep[\"type\"] {\n    switch (toolType) {\n      case TOOL.WEB_SEARCH:\n      case TOOL.IMAGE_SEARCH:\n      case TOOL.DEEP_RESEARCH:\n        return \"search\";\n        \n      case TOOL.BROWSER_USE:\n      case TOOL.VISIT:\n      case TOOL.BROWSER_VIEW:\n      case TOOL.BROWSER_NAVIGATION:\n      case TOOL.BROWSER_CLICK:\n      case TOOL.BROWSER_ENTER_TEXT:\n      case TOOL.BROWSER_SCROLL_DOWN:\n      case TOOL.BROWSER_SCROLL_UP:\n      case TOOL.BROWSER_OPEN_NEW_TAB:\n      case TOOL.BROWSER_SWITCH_TAB:\n        return \"browse\";\n        \n      case TOOL.STR_REPLACE_EDITOR:\n      case TOOL.PDF_TEXT_EXTRACT:\n        return \"edit\";\n        \n      case TOOL.BASH:\n        return \"terminal\";\n        \n      default:\n        return \"action\";\n    }\n  }\n  \n  // **新增辅助函数：解析搜索结果**\n  function parseSearchResults(result: any): SearchResultItemResponse[] {\n    if (!result) return [];\n    \n    // 如果结果是字符串，尝试解析\n    if (typeof result === \"string\") {\n      try {\n        const parsed = JSON.parse(result);\n        if (Array.isArray(parsed)) {\n          return parsed.map((item, index) => ({\n            id: `result_${index}`,\n            title: item.title || \"Untitled\",\n            url: item.url || \"\",\n            description: item.description || item.snippet || \"\"\n          }));\n        }\n      } catch (e) {\n        // 如果解析失败，返回单个结果\n        return [{\n          id: \"result_0\",\n          title: \"Search Result\",\n          url: \"\",\n          description: result\n        }];\n      }\n    }\n    \n    // 如果结果是数组\n    if (Array.isArray(result)) {\n      return result.map((item, index) => ({\n        id: `result_${index}`,\n        title: item.title || `Result ${index + 1}`,\n        url: item.url || \"\",\n        description: item.description || item.snippet || \"\"\n      }));\n    }\n    \n    // 如果结果是对象\n    if (typeof result === \"object\" && result.results) {\n      return parseSearchResults(result.results);\n    }\n    \n    return [];\n  }\n  \n  // **新增辅助函数：获取文件类型**\n  function getFileType(filePath: string): string {\n    const extension = filePath.split('.').pop()?.toLowerCase() || \"\";\n    const fileTypes: Record<string, string> = {\n      \"js\": \"javascript\",\n      \"ts\": \"typescript\",\n      \"jsx\": \"javascript\",\n      \"tsx\": \"typescript\",\n      \"py\": \"python\",\n      \"java\": \"java\",\n      \"cpp\": \"cpp\",\n      \"c\": \"c\",\n      \"cs\": \"csharp\",\n      \"go\": \"go\",\n      \"rs\": \"rust\",\n      \"php\": \"php\",\n      \"rb\": \"ruby\",\n      \"swift\": \"swift\",\n      \"kt\": \"kotlin\",\n      \"md\": \"markdown\",\n      \"json\": \"json\",\n      \"xml\": \"xml\",\n      \"yaml\": \"yaml\",\n      \"yml\": \"yaml\",\n      \"txt\": \"text\",\n      \"pdf\": \"pdf\",\n      \"doc\": \"document\",\n      \"docx\": \"document\"\n    };\n    \n    return fileTypes[extension] || \"text\";\n  }\n  \n  \n  // 辅助函数：获取工具的显示名称\n  function getToolDisplayName(toolType: TOOL): string {\n    const toolNames: Record<TOOL, string> = {\n      [TOOL.WEB_SEARCH]: \"Web Search\",\n      [TOOL.IMAGE_SEARCH]: \"Image Search\",\n      [TOOL.DEEP_RESEARCH]: \"Deep Research\",\n      [TOOL.BROWSER_USE]: \"Browser\",\n      [TOOL.VISIT]: \"Visit Page\",\n      [TOOL.STR_REPLACE_EDITOR]: \"Text Editor\",\n      [TOOL.PDF_TEXT_EXTRACT]: \"PDF Extraction\",\n      [TOOL.BASH]: \"Terminal\",\n      // ... 添加其他工具名称\n    };\n    return toolNames[toolType] || toolType;\n  }\n  \n  // 辅助函数：格式化 action 内容\n  function formatActionContent(action?: ActionStep): string {\n    if (!action) return \"\";\n    \n    const toolName = action.data.tool_name || getToolDisplayName(action.type);\n    const input = action.data.tool_input || {};\n    \n    switch (action.type) {\n      case TOOL.WEB_SEARCH:\n      case TOOL.IMAGE_SEARCH:\n        return `🔍 Searching: ${input.query || input.description || \"\"}`;\n      \n      case TOOL.BROWSER_USE:\n      case TOOL.VISIT:\n        return `🌐 Browsing: ${input.url || \"\"}`;\n      \n      case TOOL.STR_REPLACE_EDITOR:\n        return `✏️ Editing: ${input.file_path || input.file || \"\"}`;\n      \n      case TOOL.BASH:\n        return `💻 Running command: ${input.command || \"\"}`;\n      \n      default:\n        return `🔧 ${toolName}: ${input.description || input.text || \"\"}`;\n    }\n  }\n  \n  // 辅助函数：格式化结果\n  function formatResult(result: any): string {\n    if (typeof result === \"string\") {\n      return result;\n    }\n    if (typeof result === \"object\") {\n      return JSON.stringify(result, null, 2);\n    }\n    return String(result);\n  }\n  \n// 根据 TOOL 类型映射到 Operation 类型\nfunction getOperationType(toolType: TOOL): Operation[\"type\"] {\n  switch (toolType) {\n    case TOOL.WEB_SEARCH:\n    case TOOL.IMAGE_SEARCH:\n    case TOOL.DEEP_RESEARCH:\n      return \"search\";\n      \n    case TOOL.BROWSER_USE:\n    case TOOL.VISIT:\n    case TOOL.BROWSER_VIEW:\n    case TOOL.BROWSER_NAVIGATION:\n    case TOOL.BROWSER_CLICK:\n    case TOOL.BROWSER_ENTER_TEXT:\n    case TOOL.BROWSER_SCROLL_DOWN:\n    case TOOL.BROWSER_SCROLL_UP:\n    case TOOL.BROWSER_OPEN_NEW_TAB:\n    case TOOL.BROWSER_SWITCH_TAB:\n      return \"browse\";\n      \n    case TOOL.STR_REPLACE_EDITOR:\n    case TOOL.PDF_TEXT_EXTRACT:\n      return \"edit\";\n      \n    case TOOL.BASH:\n      return \"terminal\";\n      \n    // 默认归类为 file\n    default:\n      return \"file\";\n  }\n}\nconst taskData = useMemo(() => {\n  if (!messages || messages.length === 0) return null;\n  return createTaskFromMessages(messages);\n}, [messages, sessionId, isCompleted, uploadedFiles]); // 添加所有相关依赖\n\n\nconsole.log(\"op:\",operationSteps)\n\n  return (\n    <main className=\"flex h-full w-full overflow-hidden bg-manus-background\">\n      {/* 侧边栏 */}\n      <div\n        className={`transition-all duration-300 ease-in-out h-screen relative ${isMobile ? \"absolute z-50 bg-manus-background\" : \"\"\n          } ${sidebarOpen ? \"w-64\" : \"w-12\"}`}\n      >\n        <Sidebar\n          tasks={sessions}\n          loading={loading}\n          error={error}\n          onSelectTask={handleSessionClick}\n          selectedTask={selectedTask}\n          isOpen={sidebarOpen}\n          onToggle={toggleSidebar}\n          onCreateTask={handleQuestionSubmit}\n        />\n      </div>\n\n      {/* 主内容区域 */}\n      <div className=\"flex flex-1 flex-col md:flex-row overflow-hidden h-screen\">\n        {/* 聊天区域与操作步骤集成 */}\n        <div className=\"w-full md:w-3/5 h-screen flex-1 border-r border-manus-border overflow-hidden\">\n          <ChatArea\n            taskId={taskId}\n            taskData={taskData}\n            loading={loading}\n            error={error}\n            onSendMessage={handleChatAreaMessage}\n          />\n        </div>\n\n        {/* 内容显示和导航面板 */}\n        <div className=\"w-full md:w-2/5 h-screen flex-1 overflow-hidden\">\n          <OperationPanel\n            taskId={selectedTask}\n            operationSteps={operationSteps}\n            loading={loading}\n          />\n        </div>\n      </div>\n    </main>\n  )\n}\n"],"names":[],"mappings":";;;AA+Ra;;AA7Rb;AACA;AACA;AACA;AACA;AACA;AASA;AACA;AACA;AACA;AAAA;AACA;;;AApBA;;;;;;;;;;;;;AA4Be,SAAS;;IACtB,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD;IACzD,MAAM,iBAAiB,CAAA,GAAA,4RAAA,CAAA,SAAM,AAAD,EAAyB;IACrD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAiB;IAChE,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACrD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAc;IAC3D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAmB,EAAE;IACxE,MAAM,WAAW,CAAA,GAAA,0HAAA,CAAA,YAAS,AAAD;IACzB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAU;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAiB;IAC1D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IACzD,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAc,EAAE;IACvD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,eAAe,CAAA,GAAA,oQAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAC7C,CAAC;IAEH,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IAC/D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACrD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAiB,OAAO,gBAAgB;IAC7F,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE,KAAK,cAAc;IAC1E,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAoB,OAAO,iBAAiB;IAC/E,MAAM,eAAe,CAAA,GAAA,4RAAA,CAAA,UAAO,AAAD;sCAAE,IAAM,CAAC,CAAC,aAAa,GAAG,CAAC;qCAAO;QAAC;KAAa;IAC3E,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAE;IAE3D,MAAM,CAAC,QAAO,UAAU,GAAG,CAAA,GAAA,4RAAA,CAAA,WAAQ,AAAD,EAAU;IAI5C,yBAAyB;IACzB,MAAM,cAAc,CAAC;QAKnB,OAAQ,KAAK,IAAI;YACf,KAAK,iHAAA,CAAA,aAAU,CAAC,YAAY;gBAC1B,QAAQ,GAAG,CAAC,iBAAiB;gBAC7B,YAAY,CAAC,OAAS;2BACjB;wBACH;4BACE,IAAI,KAAK,EAAE;4BACX,MAAM;4BACN,SAAS,KAAK,OAAO,CAAC,IAAI;4BAC1B,WAAW,KAAK,GAAG;wBACrB;qBACD;gBACD;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,UAAU;gBACxB,aAAa;gBACb;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,cAAc;gBAC5B,iBAAiB,KAAK,OAAO,CAAC,IAAI;gBAClC;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,cAAc;gBAC5B,YAAY,CAAC,OAAS;2BACjB;wBACH;4BACE,IAAI,KAAK,EAAE;4BACX,MAAM;4BACN,SAAS,KAAK,OAAO,CAAC,IAAI;4BAC1B,WAAW,KAAK,GAAG;wBACrB;qBACD;gBACD;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,SAAS;gBACvB,6BAA6B;gBAC7B,IAAI,KAAK,OAAO,CAAC,SAAS,KAAK,iHAAA,CAAA,OAAI,CAAC,mBAAmB,EAAE;oBACvD,YAAY,CAAC,OAAS;+BACjB;4BACH;gCACE,IAAI,KAAK,EAAE;gCACX,MAAM;gCACN,SAAS,AAAC,KAAK,OAAO,CAAC,UAAU,CAAyB,OAAO;gCACjE,WAAW,KAAK,GAAG;4BACrB;yBACD;gBACH,OAAO;oBACL,MAAM,UAAmB;wBACvB,IAAI,KAAK,EAAE;wBACX,MAAM;wBACN,wBAAwB;wBACxB,QAAQ;4BAAE,MAAM,KAAK,OAAO,CAAC,SAAS;4BAAU,MAAM,KAAK,OAAO;wBAAC;wBACnE,WAAW,KAAK,GAAG;oBACrB;oBACA,0BAA0B;oBAC1B,MAAM,MAAO,KAAK,OAAO,CAAC,UAAU,EAAsB;oBAC1D,IAAI,KAAK,cAAc;oBACvB,YAAY,CAAC,OAAS;+BAAI;4BAAM;yBAAQ,GAAG,UAAU;oBACrD,kBAAkB,QAAQ,MAAM,GAAG,6BAA6B;gBAClE;gBACA;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,SAAS;gBACvB,YAAY,CAAC;oBACX,MAAM,cAAc,CAAA,GAAA,2LAAA,CAAA,UAAS,AAAD,EAAE,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,GAAG,YAAY;oBAClE,oCAAoC;oBACpC,IAAI,YAAY,MAAM,IAAI,YAAY,MAAM,CAAC,IAAI,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB,EAAE;wBAC7E,YAAY,MAAM,CAAC,IAAI,CAAC,OAAO,GAAG,KAAK,OAAO,CAAC,OAAO,EAAY,OAAO;wBACzE,YAAY,MAAM,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,OAAO,CAAC,IAAI,EAAY,OAAO;wBACnE,6BAA6B;wBAC7B,MAAM,WAAW,AAAC,KAAK,OAAO,CAAC,IAAI,EAAa,SAAS,iBACpD,KAAK,OAAO,CAAC,IAAI,GAClB,GAAG,cAAc,CAAC,EAAE,KAAK,OAAO,CAAC,IAAI,EAAE;wBAC3C,gBAAgB,CAAC,cAAgB,CAAC;gCAAE,GAAG,WAAW;gCAAE,CAAC,SAAS,EAAE,KAAK,OAAO,CAAC,OAAO;4BAAW,CAAC;oBAClG;oBACA,kBAAkB;oBAClB,WAAW,IAAM,kBAAkB,YAAY,MAAM,GAAG;oBACxD,OAAO;2BAAI,KAAK,KAAK,CAAC,GAAG,CAAC;wBAAI;qBAAY,EAAE,WAAW;gBACzD;gBACA;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,WAAW;gBACzB,kCAAkC;gBAClC,IAAI,KAAK,OAAO,CAAC,SAAS,KAAK,iHAAA,CAAA,OAAI,CAAC,WAAW,EAAE;oBAC/C,YAAY,CAAC,OAAS;+BACjB;4BACH;gCACE,IAAI,KAAK,EAAE;gCACX,MAAM;gCACN,SAAS,KAAK,OAAO,CAAC,MAAM;gCAC5B,WAAW,KAAK,GAAG;4BACrB;yBACD;gBACH,OAAO;oBACL,IAAI,KAAK,OAAO,CAAC,SAAS,KAAK,iHAAA,CAAA,OAAI,CAAC,mBAAmB,IAAI,KAAK,OAAO,CAAC,SAAS,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY,EAAE;wBACvG,YAAY,CAAC;4BACX,MAAM,cAAc,CAAA,GAAA,2LAAA,CAAA,UAAS,AAAD,EAAE,IAAI,CAAC,KAAK,MAAM,GAAG,EAAE,GAAG,YAAY;4BAClE,qBAAqB;4BACrB,IAAI,aAAa,UAAU,YAAY,MAAM,EAAE,SAAS,KAAK,OAAO,CAAC,SAAS,EAAE;gCAC9E,YAAY,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,GAAG,KAAK,OAAO,CAAC,MAAM,EAAE,EAAE,OAAO;gCAClE,2BAA2B;gCAC3B,IACE;oCACE,iHAAA,CAAA,OAAI,CAAC,YAAY;oCAAE,iHAAA,CAAA,OAAI,CAAC,aAAa;oCAAE,iHAAA,CAAA,OAAI,CAAC,kBAAkB;oCAC9D,iHAAA,CAAA,OAAI,CAAC,iBAAiB;oCAAE,iHAAA,CAAA,OAAI,CAAC,0BAA0B;oCACvD,iHAAA,CAAA,OAAI,CAAC,8BAA8B;oCAAE,iHAAA,CAAA,OAAI,CAAC,kBAAkB;oCAC5D,iHAAA,CAAA,OAAI,CAAC,oBAAoB;oCAAE,iHAAA,CAAA,OAAI,CAAC,YAAY;oCAAE,iHAAA,CAAA,OAAI,CAAC,mBAAmB;oCACtE,iHAAA,CAAA,OAAI,CAAC,iBAAiB;oCAAE,iHAAA,CAAA,OAAI,CAAC,kBAAkB;oCAAE,iHAAA,CAAA,OAAI,CAAC,eAAe;iCACtE,CAAC,QAAQ,CAAC,KAAK,OAAO,CAAC,SAAS,GACjC;oCACA,eAAe;oCACf,YAAY,MAAM,CAAC,IAAI,CAAC,MAAM,GAC5B,KAAK,OAAO,CAAC,MAAM,IAAI,MAAM,OAAO,CAAC,KAAK,OAAO,CAAC,MAAM,IACpD,KAAK,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,OAAS,KAAK,IAAI,KAAK,UAAU,QAAQ,OACnE;gCACR;gCACA,YAAY,MAAM,CAAC,IAAI,CAAC,QAAQ,GAAG,MAAM,UAAU;gCACnD,UAAU;gCACV,WAAW,IAAM,kBAAkB,YAAY,MAAM,GAAG;gCACxD,OAAO;uCAAI,KAAK,KAAK,CAAC,GAAG,CAAC;oCAAI;iCAAY,EAAE,WAAW;4BACzD,OAAO;gCACL,OAAO;uCAAI;oCAAM;wCAAE,GAAG,WAAW;wCAAE,QAAQ,KAAK,OAAO;oCAAe;iCAAE;4BAC1E;wBACF;oBACF;gBACF;gBACA;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,cAAc;gBAC5B,YAAY,CAAC,OAAS;2BACjB;wBACH;4BACE,IAAI,KAAK,GAAG,GAAG,QAAQ;4BACvB,MAAM;4BACN,SAAS,KAAK,OAAO,CAAC,IAAI;4BAC1B,WAAW,KAAK,GAAG;wBACrB;qBACD;gBACD,eAAe,OAAO,YAAY;gBAClC,aAAa,QAAQ,SAAS;gBAC9B;YACF,KAAK,iHAAA,CAAA,aAAU,CAAC,cAAc;gBAC5B,eAAe,QAAQ,SAAS;gBAChC,MAAM,WAAW,KAAK,OAAO,CAAC,KAAK;gBACnC,MAAM,QAAQ,SAAS,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI,GAAG,cAAc;gBACzD,iBAAiB,CAAC,OAAS;2BAAI;2BAAS;qBAAM,GAAG,aAAa;gBAC9D;YACF,KAAK;gBACH,2QAAA,CAAA,QAAK,CAAC,KAAK,CAAC,KAAK,OAAO,CAAC,OAAO,GAAa,SAAS;gBACtD,eAAe,QAAQ,YAAY;gBACnC,aAAa;gBACb;QACJ;IACF;IAEA,oDAAoD;IACpD,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM,KAAK,aAAa,GAAG,CAAC;YAC5B,aAAa;QACf;yBAAG;QAAC;KAAa;IAEjB,MAAM,oBAAoB,CAAA,GAAA,0LAAA,CAAA,UAAQ,AAAD,EAC/B,CAAC,MAA8B,cAAc,KAAK;QAChD,IAAI,CAAC,MAAM,QAAQ,aAAa;QAEhC,0BAA0B;QAC1B,OAAQ,KAAK,IAAI;YACf,KAAK,iHAAA,CAAA,OAAI,CAAC,UAAU;gBAElB,qBAAqB;gBACrB;YAEF,KAAK,iHAAA,CAAA,OAAI,CAAC,cAAc;YACxB,KAAK,iHAAA,CAAA,OAAI,CAAC,WAAW;YACrB,KAAK,iHAAA,CAAA,OAAI,CAAC,KAAK;gBAEb,qBAAqB;gBACrB;YACF,kBAAkB;YAClB,KAAK,iHAAA,CAAA,OAAI,CAAC,aAAa;YACvB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,iBAAiB;YAC3B,KAAK,iHAAA,CAAA,OAAI,CAAC,0BAA0B;YACpC,KAAK,iHAAA,CAAA,OAAI,CAAC,8BAA8B;YACxC,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,oBAAoB;YAC9B,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,eAAe;YACzB,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,mBAAmB;YAC7B,KAAK,iHAAA,CAAA,OAAI,CAAC,iBAAiB;gBACzB,qBAAqB;gBACrB;YAEF,KAAK,iHAAA,CAAA,OAAI,CAAC,IAAI;gBACZ,qBAAqB;gBACrB;YAEF,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;gBAE1B,qBAAqB,OAAO,WAAW;gBAGvC;YAEF;gBACE;QACJ;IACF,GACA,GAAG,YAAY;;IAGjB,iDAAiD;IACjD,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM;qDAAqB;oBACzB,MAAM,KAAK,aAAa,GAAG,CAAC,OAAO,iBAAiB;oBACpD,IAAI,CAAC,IAAI,QAAQ,iBAAiB;oBAElC,oBAAoB,OAAO,SAAS;oBACpC,IAAI;wBACF,iCAAiC;wBACjC,MAAM,WAAW,MAAM,MACrB,6DAAmC,cAAc,EAAE,GAAG,OAAO,CAAC;wBAGhE,IAAI,CAAC,SAAS,EAAE,EAAE;4BAChB,MAAM,IAAI,MACR,CAAC,+BAA+B,EAAE,SAAS,UAAU,EAAE;wBAE3D;wBAEA,MAAM,OAAO,MAAM,SAAS,IAAI,IAAI,eAAe;wBACnD,wCAAwC;wBACxC,iBAAiB,KAAK,MAAM,EAAE,CAAC,EAAE,EAAE;wBAEnC,IAAI,KAAK,MAAM,IAAI,MAAM,OAAO,CAAC,KAAK,MAAM,GAAG;4BAC7C,MAAM,wBAAmC,EAAE,EAAE,aAAa;4BAE1D,mBAAmB;4BACnB,MAAM;4FAAyB;oCAC7B,aAAa,OAAO,kBAAkB;oCACtC,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,CAAC,MAAM,EAAE,IAAK;wCAC3C,MAAM,QAAQ,KAAK,MAAM,CAAC,EAAE;wCAC5B,sBAAsB;wCACtB,MAAM,IAAI;wGAAQ,CAAC,UAAY,WAAW,SAAS;;wCACnD,2BAA2B;wCAC3B,YAAY;4CAAE,GAAG,MAAM,aAAa;4CAAE,IAAI,MAAM,EAAE;wCAAC;oCACrD;gCACA,wDAAwD;gCACxD,yCAAyC;gCAC3C;;4BAEA,0BAA0B,aAAa;4BAEvC,2BAA2B;4BAC3B,oEAAoE;4BACpE,gEAAgE;4BAChE,sBAAsB;4BACtB,IAAI,sBAAsB,MAAM,GAAG,GAAG;gCACpC,YAAY;gCACZ,eAAe;4BACjB;4BAEA,uCAAuC;4BACvC,MAAM,iBAAiB,KAAK,MAAM,CAAC,IAAI;oFACrC,CAAC,IAAc,EAAE,UAAU,KAAK,iHAAA,CAAA,aAAU,CAAC,cAAc;;4BAE3D,IAAI,kBAAkB,eAAe,aAAa,CAAC,IAAI,EAAE;gCACvD,iBAAiB,eAAe,aAAa,CAAC,IAAI;4BACpD;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,mCAAmC;wBACjD,2QAAA,CAAA,QAAK,CAAC,KAAK,CAAC,mCAAmC,SAAS;oBAC1D,SAAU;wBACR,oBAAoB,QAAQ,WAAW;oBACzC;gBACF;;YAEA,sBAAsB,cAAc;QACtC;yBAAG;QAAC;KAAa,GAAG,uBAAuB;IAG3C,2BAA2B;IAC3B,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,IAAI,mBAAmB,iNAAA,CAAA,UAAO,CAAC,GAAG,CAAC,cAAc,6BAA6B;YAE9E,IAAI,CAAC,kBAAkB;gBACrB,mBAAmB,CAAA,GAAA,0OAAA,CAAA,KAAM,AAAD,KAAK,2BAA2B;gBACxD,mCAAmC;gBACnC,iNAAA,CAAA,UAAO,CAAC,GAAG,CAAC,aAAa,kBAAkB;oBACzC,SAAS;oBACT,UAAU;oBACV,QAAQ,OAAO,QAAQ,CAAC,QAAQ,KAAK;gBACvC;gBACA,QAAQ,GAAG,CAAC,4BAA4B;YAC1C,OAAO;gBACL,QAAQ,GAAG,CAAC,6BAA6B;YAC3C;YACA,YAAY,mBAAmB,uBAAuB;QACxD;yBAAG,EAAE,GAAG,oBAAoB;IAE5B,SAAS;IACT,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM;4CAAY;oBAChB,uBAAuB;oBACvB,IAAI,CAAC,UAAU;oBAEf,IAAI;wBACF,WAAW;wBACX,SAAS,MAAM,YAAY;;wBAE3B,aAAa;wBACb,MAAM,WAAW,MAAM,MACrB,6DAAmC,cAAc,EAAE,UAAU;wBAE/D,IAAI,CAAC,SAAS,EAAE,EAAE;4BAChB,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,SAAS,UAAU,EAAE;wBACnE;wBAEA,MAAM,OAAO,MAAM,SAAS,IAAI;wBAChC,MAAM,cAAc,KAAK,QAAQ,IAAI,EAAE;wBAEvC,uCAAuC;wBACvC,MAAM,aAAa,YAAY,GAAG;mEAAC,CAAC;gCAClC,OAAO;gCACP,IAAI;gCACJ,IAAI,QAAQ,aAAa,EAAE,SAAS,OAAO;oCACzC,OAAO;gCACT,OAAO,IAAI,QAAQ,KAAK,EAAE,SAAS,SAAS,QAAQ,KAAK,EAAE,SAAS,QAAQ;oCAC1E,OAAO;gCACT,OAAO;oCACL,OAAO;gCACT;gCAEA,QAAQ;gCACR,MAAM,cAAc,IAAI,KAAK,QAAQ,UAAU;gCAC/C,MAAM,MAAM,IAAI;gCAChB,MAAM,SAAS,IAAI,OAAO,KAAK,YAAY,OAAO;gCAClD,MAAM,WAAW,KAAK,KAAK,CAAC,SAAS;gCACrC,MAAM,YAAY,KAAK,KAAK,CAAC,WAAW;gCACxC,MAAM,WAAW,KAAK,KAAK,CAAC,YAAY;gCACxC,MAAM,aAAa,KAAK,KAAK,CAAC,WAAW;gCAEzC,IAAI,cAAc;gCAClB,IAAI,aAAa,GAAG;oCAClB,cAAc,GAAG,WAAW,IAAI,CAAC;gCACnC,OAAO,IAAI,WAAW,GAAG;oCACvB,cAAc,GAAG,SAAS,GAAG,CAAC;gCAChC,OAAO,IAAI,YAAY,GAAG;oCACxB,cAAc,GAAG,UAAU,IAAI,CAAC;gCAClC,OAAO,IAAI,WAAW,GAAG;oCACvB,cAAc,GAAG,SAAS,IAAI,CAAC;gCACjC,OAAO;oCACL,cAAc;gCAChB;gCAIA,OAAO;oCACL,GAAG,OAAO;oCACV,IAAI,QAAQ,EAAE;oCACd,OAAO,QAAQ,aAAa;oCAC5B,MAAM;oCACN,QAAQ;oCACR,MAAM;gCACR;4BACF;;wBAEA,YAAY,YAAY,iCAAiC;;oBAG3D,EAAE,OAAO,KAAK;wBACZ,MAAM,QAAQ;wBACd,QAAQ,KAAK,CAAC,6BAA6B;wBAC3C,SAAS,CAAC,yBAAyB,EAAE,MAAM,OAAO,IAAI,qBAAqB;oBAC7E,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;QACF;yBAAG;QAAC;KAAS,EAAE,iBAAiB;;IAGhC,MAAM,qBAAqB,CAAC;QAC1B,OAAO,QAAQ,CAAC,IAAI,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,sBAAsB;IAGpE;IACA,yCAAyC;IACzC,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM,KAAK,aAAa,GAAG,CAAC,OAAO,oBAAoB;YACvD,IAAI,IAAI;gBACN,mBAAmB,KAAK,0BAA0B;YACpD,OAAO;gBACL,mBAAmB,OAAO,eAAe;YAC3C;QACF;yBAAG;QAAC;KAAa,GAAG,uBAAuB;IAG1C,gDAAgD;IAChD,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACT,MAAM;mDAAmB;oBACvB,MAAM,SAAS,IAAI,gBAAgB;wBAAE,WAAW;oBAAS,IAAI,qBAAqB;oBAClF,MAAM,KAAK,IAAI,UAAU,6DAAmC,IAAI,EAAE,OAAO,QAAQ,IAAI;oBACrF,GAAG,MAAM;2DAAG;4BACV,QAAQ,GAAG,CAAC;4BACZ,uCAAuC;4BACvC,GAAG,IAAI,CAAC,KAAK,SAAS,CAAC;gCAAE,MAAM;gCAAkB,SAAS,CAAC;4BAAE;wBAC/D;;oBACA,GAAG,SAAS;2DAAG,CAAC;4BACd,IAAI;gCACF,MAAM,OAAO,KAAK,KAAK,CAAC,MAAM,IAAI,GAAa,aAAa;gCAC5D,mCAAmC;gCACnC,YAAY;oCAAE,GAAG,IAAI;oCAAE,IAAI,KAAK,GAAG,GAAG,QAAQ;gCAAG;4BACnD,EAAE,OAAO,OAAO;gCACd,QAAQ,KAAK,CAAC,iCAAiC;4BACjD;wBACF;;oBACA,GAAG,OAAO;2DAAG,CAAC;4BACZ,QAAQ,GAAG,CAAC,oBAAoB;4BAChC,2QAAA,CAAA,QAAK,CAAC,KAAK,CAAC;wBACd;;oBACA,GAAG,OAAO;2DAAG;4BACX,QAAQ,GAAG,CAAC;4BACZ,UAAU,OAAO,eAAe;wBAClC;;oBACA,UAAU,KAAK,kBAAkB;gBACnC;;YAEA,IAAI,YAAY,CAAC,cAAc;gBAC7B,oBAAoB,OAAO;YAC7B;YACA;kCAAO;oBACL,IAAI,QAAQ,OAAO,KAAK,IAAI,kBAAkB;gBAChD;;QACF,uDAAuD;QACvD;yBAAG;QAAC;QAAU;KAAa,GAAG,8BAA8B;IAK5D,cAAc;IACd,MAAM,uBAAuB,OAAO;QAClC,MAAM,YAAY,CAAA,GAAA,0OAAA,CAAA,KAAM,AAAD;QACzB,UAAU;QACR,IAAI,CAAC,YAAY,IAAI,MAAM,WAAW,QAAQ,mBAAmB;QAEjE,aAAa,OAAO,SAAS;QAC7B,mBAAmB,KAAK,gDAAgD;QACxE,eAAe,QAAQ,SAAS;QAEhC,kDAAkD;QAClD,IAAI,CAAC,WAAW;YACd,MAAM,KAAK,GAAG,eAAe,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,cAAc;YAC9D,IAAI,IAAI;gBACN,aAAa;YACf;QACF;QAEA,WAAW;QACX,MAAM,iBAA2B;YAC/B,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,MAAM;YACN,SAAS;YACT,WAAW,KAAK,GAAG;QACrB;QACA,YAAY,CAAC,OAAS;mBAAI;gBAAM;aAAe,GAAG,eAAe;QAEjE,sBAAsB;QACtB,IAAI,CAAC,UAAU,OAAO,UAAU,KAAK,UAAU,IAAI,EAAE;YACnD,2QAAA,CAAA,QAAK,CAAC,KAAK,CAAC;YACZ,aAAa;YACb;QACF;QAEA,kCAAkC;QAClC,IAAI,CAAC,WAAW;YACd,OAAO,IAAI,CACT,KAAK,SAAS,CAAC;gBACb,MAAM;gBACN,SAAS;oBACP,WAAW;wBACT,eAAe;wBACf,KAAK;wBACL,kBAAkB;wBAClB,kBAAkB;wBAClB,SAAS;oBACX;gBACF;YACF;QAEJ;QAEA,sBAAsB;QACtB,OAAO,IAAI,CACT,KAAK,SAAS,CAAC;YACb,MAAM;YACN,SAAS;gBACP,MAAM;gBACN,QAAQ,SAAS,MAAM,GAAG;gBAC1B,qBAAqB;gBACrB,OAAO,eAAe,IAAI,CAAC,OAAS,CAAC,CAAC,EAAE,MAAM;YAChD;QACF;QAGF,QAAQ,GAAG,CAAC;IACd;IAGA,MAAM,wBAAwB,CAAC;QAC7B,QAAQ,GAAG,CAAC,kBAAkB;QAE9B,6BAA6B;QAC7B,IAAI,CAAC,cAAc;YACjB,iBAAiB;YACjB,iBAAiB;YACjB,QAAQ,GAAG,CAAC;QACd;QAEA,6BAA6B;QAC7B,qBAAqB;IACvB;IAOA,MAAM,gBAAgB;QACpB,eAAe,CAAC;IAClB;IAEA,CAAA,GAAA,4RAAA,CAAA,YAAS,AAAD;0BAAE;YACR,eAAe,OAAO,EAAE,eAAe;gBAAE,UAAU;YAAS;QAC9D;yBAAG;QAAC,UAAU;KAAO;IAErB,MAAM,yBAAyB,CAAC;QAC9B,MAAM,YAAY,IAAI,OAAO,WAAW;QACxC,MAAM,SAAS,aAAa,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;QAChD,gBAAgB;QAEhB,MAAM,eAA0B,EAAE;QAClC,MAAM,YAAqB,EAAE;QAC7B,MAAM,gBAA6B,EAAE;QACrC,MAAM,WAA2B,EAAE;QACnC,0DAA0D;QAE1D,WAAW;QACX,IAAI,cAAoC;QACxC,IAAI,cAAc;QAElB,SAAS,OAAO,CAAC,CAAC,KAAK;YACrB,mBAAmB;YACnB,IAAI,IAAI,OAAO,EAAE;gBACf,MAAM,cAAuB;oBAC3B,IAAI,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC;oBACpB,MAAM,IAAI,IAAI,KAAK,SAAS,SAAS;oBACrC,SAAS,IAAI,OAAO;oBACpB,WAAW,IAAI,KAAK,IAAI,SAAS,EAAE,WAAW;oBAC9C,QAAQ;oBACR,QAAQ,IAAI,IAAI;gBAClB;gBACA,aAAa,IAAI,CAAC;gBAElB,iBAAiB;gBACjB,MAAM,iBAAmC;oBACvC,IAAI,CAAC,QAAQ,EAAE,IAAI,EAAE,CAAC,QAAQ,CAAC;oBAC/B,OAAO,IAAI,IAAI,KAAK,SAAS,eAAe;oBAC5C,MAAM;oBACN,aAAa,IAAI,OAAO,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,IAAI,OAAO,CAAC,MAAM,GAAG,MAAM,QAAQ,EAAE;oBAC/E,WAAW,IAAI,KAAK,IAAI,SAAS;oBACjC,SAAS,IAAI,OAAO;oBACpB,eAAe;oBACf,MAAM;wBACJ,MAAM,IAAI,IAAI;wBACd,SAAS,IAAI,OAAO;wBACpB,QAAQ;oBACV;gBACF;gBAEA,mBAAmB;gBACnB,IAAI,IAAI,IAAI,KAAK,QAAQ;oBACvB;oBACA,cAAc;wBACZ,IAAI,CAAC,KAAK,EAAE,aAAa;wBACzB,OAAO,CAAC,KAAK,EAAE,YAAY,EAAE,EAAE,IAAI,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC;wBAC5D,aAAa,IAAI,OAAO;wBACxB,WAAW,IAAI,KAAK,IAAI,SAAS;wBACjC,QAAQ;wBACR,iBAAiB;wBACjB,UAAU;4BAAC;yBAAe;wBAC1B,YAAY;oBACd;oBACA,eAAe,IAAI,CAAC;gBACtB,OAAO,IAAI,aAAa;oBACtB,kBAAkB;oBAClB,YAAY,QAAQ,CAAC,IAAI,CAAC;gBAC5B;YACF;YAEA,uCAAuC;YACvC,IAAI,IAAI,MAAM,EAAE;gBACd,MAAM,gBAAgB,iBAAiB,IAAI,MAAM,CAAC,IAAI;gBACtD,MAAM,YAAY,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC;gBAEjD,eAAe;gBACf,MAAM,YAAuB;oBAC3B,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE;oBAClB,MAAM;oBACN,SAAS,UAAU,WAAW,IACrB,UAAU,IAAI,IACd,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,IACvB,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,IAAI;oBAClC,WAAW,IAAI,KAAK,IAAI,SAAS;oBACjC,KAAK,UAAU,GAAG;oBAClB,UAAU,UAAU,SAAS,IAAI,UAAU,eAAe;oBAC1D,MAAM,IAAI,MAAM,CAAC,IAAI;gBACvB;gBACA,cAAc,IAAI,CAAC;gBAEnB,WAAW;gBACX,MAAM,QAAe;oBACnB,IAAI,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE;oBACrB,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,IAAI,mBAAmB,IAAI,MAAM,CAAC,IAAI;oBACtE,WAAW,IAAI,KAAK,IAAI,SAAS;oBACjC,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,GAAG,cAAc;oBACjD,YAAY;wBAAC;qBAAU;gBACzB;gBACA,UAAU,IAAI,CAAC;gBAEf,uBAAuB;gBACvB,MAAM,gBAAyB;oBAC7B,IAAI,GAAG,IAAI,EAAE,CAAC,OAAO,CAAC;oBACtB,MAAM;oBACN,SAAS,oBAAoB,IAAI,MAAM;oBACvC,WAAW,IAAI,KAAK,IAAI,SAAS,EAAE,WAAW;oBAC9C,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,GAAG,cAAc;oBACjD,SAAS,KAAK,SAAS,CAAC,WAAW,MAAM;oBACzC,QAAQ;gBACV;gBACA,aAAa,IAAI,CAAC;gBAElB,sBAAsB;gBACtB,MAAM,eAAwB;oBAC5B,IAAI,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC;oBACrB,MAAM;oBACN,SAAS,GAAG,MAAM,KAAK,CAAC,EAAE,EAAE,UAAU,OAAO,EAAE;oBAC/C,WAAW,IAAI,KAAK,IAAI,SAAS,EAAE,WAAW;oBAC9C,QAAQ,MAAM,MAAM;oBACpB,QAAQ;gBACV;gBACA,aAAa,IAAI,CAAC;gBAElB,cAAc;gBACd,MAAM,UAAU,uBAAuB,IAAI,MAAM,EAAE,IAAI,EAAE,EAAE,IAAI,SAAS,EAAE;gBAE1E,mBAAmB;gBACnB,IAAI,CAAC,aAAa;oBAChB;oBACA,cAAc;wBACZ,IAAI,CAAC,KAAK,EAAE,aAAa;wBACzB,OAAO,CAAC,KAAK,EAAE,YAAY,EAAE,EAAE,mBAAmB,IAAI,MAAM,CAAC,IAAI,GAAG;wBACpE,aAAa,oBAAoB,IAAI,MAAM;wBAC3C,WAAW,IAAI,KAAK,IAAI,SAAS;wBACjC,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,GAAG,cAAc;wBACjD,iBAAiB;wBACjB,UAAU;4BAAC;yBAAQ;wBACnB,YAAY;oBACd;oBACA,eAAe,IAAI,CAAC;gBACtB,OAAO;oBACL,UAAU;oBACV,YAAY,QAAQ,CAAC,IAAI,CAAC;oBAC1B,SAAS;oBACT,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE;wBAC5B,YAAY,MAAM,GAAG;oBACvB;gBACF;gBAEA,eAAe;gBACf,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE;oBAC1B,MAAM,gBAAyB;wBAC7B,IAAI,GAAG,IAAI,EAAE,CAAC,OAAO,CAAC;wBACtB,MAAM;wBACN,SAAS,aAAa,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM;wBAC5C,WAAW,IAAI,KAAK,IAAI,SAAS,GAAG,GAAG,WAAW;wBAClD,QAAQ;wBACR,QAAQ;oBACV;oBACA,aAAa,IAAI,CAAC;gBACpB;YACF;YAEA,kBAAkB;YAClB,SAAS,IAAI,CAAC;gBACZ,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE;gBACxB,cAAc,IAAI,MAAM,GAAG,SAAS;gBACpC,QAAQ,IAAI,IAAI,KAAK,SAAS,SAAS;gBACvC,SAAS,IAAI,OAAO,IAAI,oBAAoB,IAAI,MAAM;gBACtD,WAAW,IAAI,KAAK,IAAI,SAAS,EAAE,WAAW;gBAC9C,iBAAiB,QAAQ;gBACzB,iBAAiB,IAAI,MAAM,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG;gBAClD,YAAY,IAAI,MAAM,GAAG;oBAAC,aAAa,CAAC,cAAc,MAAM,GAAG,EAAE;iBAAC,GAAG,EAAE;YACzE;QACF;QAEA,MAAM,OAAa;YACjB,IAAI;YACJ,OAAO,QAAQ,CAAC,EAAE,EAAE,SAAS,MAAM,GAAG,OAAO;YAC7C,QAAQ,cAAc,cAAc;YACpC,YAAY;YACZ,YAAY;YACZ,UAAU;YACV,QAAQ;YACR,UAAU;YACV,gBAAgB;YAChB,UAAU;gBACR,QAAQ,cAAc,cAAc;gBACpC,aAAa;gBACb,kBAAkB,cAAc,MAAM;gBACtC,aAAa,UAAU,MAAM;YAC/B;QACF;QAEA,OAAO;IACT;IAEA,qBAAqB;IACrB,SAAS,uBACP,MAAkB,EAClB,KAAa,EACb,SAAiB,EACjB,YAAoB;QAEpB,MAAM,YAAY,OAAO,IAAI,CAAC,UAAU,IAAI,CAAC;QAC7C,MAAM,OAAO,wBAAwB,OAAO,IAAI;QAEhD,MAAM,cAAgC;YACpC,IAAI,CAAC,QAAQ,EAAE,OAAO;YACtB,OAAO,mBAAmB,OAAO,IAAI;YACrC,MAAM;YACN,aAAa,UAAU,WAAW,IAAI,UAAU,IAAI,IAAI;YACxD,WAAW,IAAI,KAAK;YACpB,eAAe;QACjB;QAEA,eAAe;QACf,OAAQ;YACN,KAAK;gBACH,YAAY,IAAI,GAAG;oBACjB,OAAO,UAAU,KAAK,IAAI,UAAU,IAAI,IAAI;oBAC5C,SAAS,mBAAmB,OAAO,IAAI,CAAC,MAAM;gBAChD;gBACA;YAEF,KAAK;gBACH,YAAY,GAAG,GAAG,UAAU,GAAG;gBAC/B,YAAY,IAAI,GAAG;oBACjB,KAAK,UAAU,GAAG,IAAI;oBACtB,OAAO,UAAU,IAAI,IAAI;oBACzB,YAAY,OAAO,IAAI,CAAC,MAAM,EAAE;gBAClC;gBACA;YAEF,KAAK;gBACH,YAAY,QAAQ,GAAG,UAAU,SAAS,IAAI,UAAU,IAAI,IAAI;gBAChE,YAAY,IAAI,GAAG;oBACjB,UAAU,UAAU,SAAS,IAAI,UAAU,IAAI,IAAI;oBACnD,UAAU,YAAY,UAAU,SAAS,IAAI;oBAC7C,SAAS,UAAU,SAAS,IAAI,UAAU,IAAI,IAAI;oBAClD,MAAM,OAAO,IAAI,CAAC,MAAM,EAAE;gBAC5B;gBACA;YAEF,KAAK;gBACH,YAAY,IAAI,GAAG;oBACjB,SAAS,UAAU,OAAO,IAAI;oBAC9B,QAAQ,aAAa,OAAO,IAAI,CAAC,MAAM;gBACzC;gBACA;YAEF,KAAK;YACL;gBACE,YAAY,IAAI,GAAG;oBACjB,QAAQ,OAAO,IAAI,CAAC,SAAS,IAAI,OAAO,IAAI;oBAC5C,SAAS,KAAK,SAAS,CAAC,WAAW,MAAM;oBACzC,SAAS,aAAa,OAAO,IAAI,CAAC,MAAM;gBAC1C;gBACA;QACJ;QAEA,OAAO;IACT;IAEA,uBAAuB;IACvB,SAAS,wBAAwB,QAAc;QAC7C,OAAQ;YACN,KAAK,iHAAA,CAAA,OAAI,CAAC,UAAU;YACpB,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,aAAa;gBACrB,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,WAAW;YACrB,KAAK,iHAAA,CAAA,OAAI,CAAC,KAAK;YACf,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,aAAa;YACvB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,mBAAmB;YAC7B,KAAK,iHAAA,CAAA,OAAI,CAAC,iBAAiB;YAC3B,KAAK,iHAAA,CAAA,OAAI,CAAC,oBAAoB;YAC9B,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;gBAC1B,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,gBAAgB;gBACxB,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,IAAI;gBACZ,OAAO;YAET;gBACE,OAAO;QACX;IACF;IAEA,oBAAoB;IACpB,SAAS,mBAAmB,MAAW;QACrC,IAAI,CAAC,QAAQ,OAAO,EAAE;QAEtB,gBAAgB;QAChB,IAAI,OAAO,WAAW,UAAU;YAC9B,IAAI;gBACF,MAAM,SAAS,KAAK,KAAK,CAAC;gBAC1B,IAAI,MAAM,OAAO,CAAC,SAAS;oBACzB,OAAO,OAAO,GAAG,CAAC,CAAC,MAAM,QAAU,CAAC;4BAClC,IAAI,CAAC,OAAO,EAAE,OAAO;4BACrB,OAAO,KAAK,KAAK,IAAI;4BACrB,KAAK,KAAK,GAAG,IAAI;4BACjB,aAAa,KAAK,WAAW,IAAI,KAAK,OAAO,IAAI;wBACnD,CAAC;gBACH;YACF,EAAE,OAAO,GAAG;gBACV,gBAAgB;gBAChB,OAAO;oBAAC;wBACN,IAAI;wBACJ,OAAO;wBACP,KAAK;wBACL,aAAa;oBACf;iBAAE;YACJ;QACF;QAEA,UAAU;QACV,IAAI,MAAM,OAAO,CAAC,SAAS;YACzB,OAAO,OAAO,GAAG,CAAC,CAAC,MAAM,QAAU,CAAC;oBAClC,IAAI,CAAC,OAAO,EAAE,OAAO;oBACrB,OAAO,KAAK,KAAK,IAAI,CAAC,OAAO,EAAE,QAAQ,GAAG;oBAC1C,KAAK,KAAK,GAAG,IAAI;oBACjB,aAAa,KAAK,WAAW,IAAI,KAAK,OAAO,IAAI;gBACnD,CAAC;QACH;QAEA,UAAU;QACV,IAAI,OAAO,WAAW,YAAY,OAAO,OAAO,EAAE;YAChD,OAAO,mBAAmB,OAAO,OAAO;QAC1C;QAEA,OAAO,EAAE;IACX;IAEA,oBAAoB;IACpB,SAAS,YAAY,QAAgB;QACnC,MAAM,YAAY,SAAS,KAAK,CAAC,KAAK,GAAG,IAAI,iBAAiB;QAC9D,MAAM,YAAoC;YACxC,MAAM;YACN,MAAM;YACN,OAAO;YACP,OAAO;YACP,MAAM;YACN,QAAQ;YACR,OAAO;YACP,KAAK;YACL,MAAM;YACN,MAAM;YACN,MAAM;YACN,OAAO;YACP,MAAM;YACN,SAAS;YACT,MAAM;YACN,MAAM;YACN,QAAQ;YACR,OAAO;YACP,QAAQ;YACR,OAAO;YACP,OAAO;YACP,OAAO;YACP,OAAO;YACP,QAAQ;QACV;QAEA,OAAO,SAAS,CAAC,UAAU,IAAI;IACjC;IAGA,iBAAiB;IACjB,SAAS,mBAAmB,QAAc;QACxC,MAAM,YAAkC;YACtC,CAAC,iHAAA,CAAA,OAAI,CAAC,UAAU,CAAC,EAAE;YACnB,CAAC,iHAAA,CAAA,OAAI,CAAC,YAAY,CAAC,EAAE;YACrB,CAAC,iHAAA,CAAA,OAAI,CAAC,aAAa,CAAC,EAAE;YACtB,CAAC,iHAAA,CAAA,OAAI,CAAC,WAAW,CAAC,EAAE;YACpB,CAAC,iHAAA,CAAA,OAAI,CAAC,KAAK,CAAC,EAAE;YACd,CAAC,iHAAA,CAAA,OAAI,CAAC,kBAAkB,CAAC,EAAE;YAC3B,CAAC,iHAAA,CAAA,OAAI,CAAC,gBAAgB,CAAC,EAAE;YACzB,CAAC,iHAAA,CAAA,OAAI,CAAC,IAAI,CAAC,EAAE;QAEf;QACA,OAAO,SAAS,CAAC,SAAS,IAAI;IAChC;IAEA,qBAAqB;IACrB,SAAS,oBAAoB,MAAmB;QAC9C,IAAI,CAAC,QAAQ,OAAO;QAEpB,MAAM,WAAW,OAAO,IAAI,CAAC,SAAS,IAAI,mBAAmB,OAAO,IAAI;QACxE,MAAM,QAAQ,OAAO,IAAI,CAAC,UAAU,IAAI,CAAC;QAEzC,OAAQ,OAAO,IAAI;YACjB,KAAK,iHAAA,CAAA,OAAI,CAAC,UAAU;YACpB,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;gBACpB,OAAO,CAAC,cAAc,EAAE,MAAM,KAAK,IAAI,MAAM,WAAW,IAAI,IAAI;YAElE,KAAK,iHAAA,CAAA,OAAI,CAAC,WAAW;YACrB,KAAK,iHAAA,CAAA,OAAI,CAAC,KAAK;gBACb,OAAO,CAAC,aAAa,EAAE,MAAM,GAAG,IAAI,IAAI;YAE1C,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;gBAC1B,OAAO,CAAC,YAAY,EAAE,MAAM,SAAS,IAAI,MAAM,IAAI,IAAI,IAAI;YAE7D,KAAK,iHAAA,CAAA,OAAI,CAAC,IAAI;gBACZ,OAAO,CAAC,oBAAoB,EAAE,MAAM,OAAO,IAAI,IAAI;YAErD;gBACE,OAAO,CAAC,GAAG,EAAE,SAAS,EAAE,EAAE,MAAM,WAAW,IAAI,MAAM,IAAI,IAAI,IAAI;QACrE;IACF;IAEA,aAAa;IACb,SAAS,aAAa,MAAW;QAC/B,IAAI,OAAO,WAAW,UAAU;YAC9B,OAAO;QACT;QACA,IAAI,OAAO,WAAW,UAAU;YAC9B,OAAO,KAAK,SAAS,CAAC,QAAQ,MAAM;QACtC;QACA,OAAO,OAAO;IAChB;IAEF,6BAA6B;IAC7B,SAAS,iBAAiB,QAAc;QACtC,OAAQ;YACN,KAAK,iHAAA,CAAA,OAAI,CAAC,UAAU;YACpB,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,aAAa;gBACrB,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,WAAW;YACrB,KAAK,iHAAA,CAAA,OAAI,CAAC,KAAK;YACf,KAAK,iHAAA,CAAA,OAAI,CAAC,YAAY;YACtB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,aAAa;YACvB,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,mBAAmB;YAC7B,KAAK,iHAAA,CAAA,OAAI,CAAC,iBAAiB;YAC3B,KAAK,iHAAA,CAAA,OAAI,CAAC,oBAAoB;YAC9B,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;gBAC1B,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,kBAAkB;YAC5B,KAAK,iHAAA,CAAA,OAAI,CAAC,gBAAgB;gBACxB,OAAO;YAET,KAAK,iHAAA,CAAA,OAAI,CAAC,IAAI;gBACZ,OAAO;YAET,aAAa;YACb;gBACE,OAAO;QACX;IACF;IACA,MAAM,WAAW,CAAA,GAAA,4RAAA,CAAA,UAAO,AAAD;kCAAE;YACvB,IAAI,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG,OAAO;YAC/C,OAAO,uBAAuB;QAChC;iCAAG;QAAC;QAAU;QAAW;QAAa;KAAc,GAAG,WAAW;IAGlE,QAAQ,GAAG,CAAC,OAAM;IAEhB,qBACE,4TAAC;QAAK,WAAU;;0BAEd,4TAAC;gBACC,WAAW,CAAC,0DAA0D,EAAE,WAAW,sCAAsC,GACtH,CAAC,EAAE,cAAc,SAAS,QAAQ;0BAErC,cAAA,4TAAC,yHAAA,CAAA,UAAO;oBACN,OAAO;oBACP,SAAS;oBACT,OAAO;oBACP,cAAc;oBACd,cAAc;oBACd,QAAQ;oBACR,UAAU;oBACV,cAAc;;;;;;;;;;;0BAKlB,4TAAC;gBAAI,WAAU;;kCAEb,4TAAC;wBAAI,WAAU;kCACb,cAAA,4TAAC,8HAAA,CAAA,WAAQ;4BACP,QAAQ;4BACR,UAAU;4BACV,SAAS;4BACT,OAAO;4BACP,eAAe;;;;;;;;;;;kCAKnB,4TAAC;wBAAI,WAAU;kCACb,cAAA,4TAAC,oIAAA,CAAA,iBAAc;4BACb,QAAQ;4BACR,gBAAgB;4BAChB,SAAS;;;;;;;;;;;;;;;;;;;;;;;AAMrB;GA1jCwB;;QAUL,0HAAA,CAAA,YAAS;QASL,oQAAA,CAAA,kBAAe;;;KAnBd","debugId":null}}]
}